{"version":3,"sources":["charts.js"],"names":[],"mappings":"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","file":"charts-compiled.js","sourcesContent":["/*\n * 图片转换对话框脚本\n **/\n\nvar tableData = [],\n    //编辑器页面table\n    editorTable = null,\n    chartsConfig = window.typeConfig,\n    resizeTimer = null,\n    //初始默认图表类型\n    currentChartType = 0;\n\nwindow.onload = function () {\n\n    editorTable = domUtils.findParentByTagName( editor.selection.getRange().startContainer, 'table', true);\n\n    //未找到表格， 显示错误页面\n    if ( !editorTable ) {\n        document.body.innerHTML = \"<div class='edui-charts-not-data'>未找到数据</div>\";\n        return;\n    }\n\n    //初始化图表类型选择\n    initChartsTypeView();\n    renderTable( editorTable );\n    initEvent();\n    initUserConfig( editorTable.getAttribute( \"data-chart\" ) );\n    $( \"#scrollBed .view-box:eq(\"+ currentChartType +\")\" ).trigger( \"click\" );\n    updateViewType( currentChartType );\n\n    dialog.addListener( \"resize\", function () {\n\n        if ( resizeTimer != null ) {\n            window.clearTimeout( resizeTimer );\n        }\n\n        resizeTimer = window.setTimeout( function () {\n\n            resizeTimer = null;\n\n            renderCharts();\n\n        }, 500 );\n\n    } );\n\n};\n\nfunction initChartsTypeView () {\n\n    var contents = [];\n\n    for ( var i = 0, len = chartsConfig.length; i<len; i++ ) {\n\n        contents.push( '<div class=\"view-box\" data-chart-type=\"'+ i +'\"><img width=\"300\" src=\"images/charts'+ i +'.png\"></div>' );\n\n    }\n\n    $( \"#scrollBed\" ).html( contents.join( \"\" ) );\n\n}\n\n//渲染table， 以便用户修改数据\nfunction renderTable ( table ) {\n\n    var tableHtml = [];\n\n    //构造数据\n    for ( var i = 0, row; row = table.rows[ i ]; i++ ) {\n\n        tableData[ i ] = [];\n        tableHtml[ i ] = [];\n\n        for ( var j = 0, cell; cell = row.cells[ j ]; j++ ) {\n\n            var value = getCellValue( cell );\n\n            if ( i > 0 && j > 0 ) {\n                value = +value;\n            }\n\n            if ( i === 0 || j === 0 ) {\n                tableHtml[ i ].push( '<th>'+ value +'</th>' );\n            } else {\n                tableHtml[ i ].push( '<td><input type=\"text\" class=\"data-item\" value=\"'+ value +'\"></td>' );\n            }\n\n            tableData[ i ][ j ] = value;\n\n        }\n\n        tableHtml[ i ] = tableHtml[ i ].join( \"\" );\n\n    }\n\n    //draw 表格\n    $( \"#tableContainer\" ).html( '<table id=\"showTable\" border=\"1\"><tbody><tr>'+ tableHtml.join( \"</tr><tr>\" ) +'</tr></tbody></table>' );\n\n}\n\n/*\n * 根据表格已有的图表属性初始化当前图表属性\n */\nfunction initUserConfig ( config ) {\n\n    var parsedConfig = {};\n\n    if ( !config ) {\n        return;\n    }\n\n    config = config.split( \";\" );\n\n    $.each( config, function ( index, item ) {\n\n        item = item.split( \":\" );\n        parsedConfig[ item[ 0 ] ] = item[ 1 ];\n\n    } );\n\n    setUserConfig( parsedConfig );\n\n}\n\nfunction initEvent () {\n\n    var cacheValue = null,\n        //图表类型数\n        typeViewCount = chartsConfig.length- 1,\n        $chartsTypeViewBox = $( '#scrollBed .view-box' );\n\n    $( \".charts-format\" ).delegate( \".format-ctrl\", \"change\", function () {\n\n        renderCharts();\n\n    } )\n\n    $( \".table-view\" ).delegate( \".data-item\", \"focus\", function () {\n\n        cacheValue = this.value;\n\n    } ).delegate( \".data-item\", \"blur\", function () {\n\n        if ( this.value !== cacheValue ) {\n            renderCharts();\n        }\n\n        cacheValue = null;\n\n    } );\n\n    $( \"#buttonContainer\" ).delegate( \"a\", \"click\", function (e) {\n\n        e.preventDefault();\n\n        if ( this.getAttribute( \"data-title\" ) === 'prev' ) {\n\n            if ( currentChartType > 0 ) {\n                currentChartType--;\n                updateViewType( currentChartType );\n            }\n\n        } else {\n\n            if ( currentChartType < typeViewCount ) {\n                currentChartType++;\n                updateViewType( currentChartType );\n            }\n\n        }\n\n    } );\n\n    //图表类型变化\n    $( '#scrollBed' ).delegate( \".view-box\", \"click\", function (e) {\n\n        var index = $( this ).attr( \"data-chart-type\" );\n        $chartsTypeViewBox.removeClass( \"selected\" );\n        $( $chartsTypeViewBox[ index ] ).addClass( \"selected\" );\n\n        currentChartType = index | 0;\n\n        //饼图， 禁用部分配置\n        if ( currentChartType === chartsConfig.length - 1 ) {\n\n            disableNotPieConfig();\n\n        //启用完整配置\n        } else {\n\n            enableNotPieConfig();\n\n        }\n\n        renderCharts();\n\n    } );\n\n}\n\nfunction renderCharts () {\n\n    var data = collectData();\n\n    $('#chartsContainer').highcharts( $.extend( {}, chartsConfig[ currentChartType ], {\n\n        credits: {\n            enabled: false\n        },\n        exporting: {\n            enabled: false\n        },\n        title: {\n            text: data.title,\n            x: -20 //center\n        },\n        subtitle: {\n            text: data.subTitle,\n            x: -20\n        },\n        xAxis: {\n            title: {\n                text: data.xTitle\n            },\n            categories: data.categories\n        },\n        yAxis: {\n            title: {\n                text: data.yTitle\n            },\n            plotLines: [{\n                value: 0,\n                width: 1,\n                color: '#808080'\n            }]\n        },\n        tooltip: {\n            enabled: true,\n            valueSuffix: data.suffix\n        },\n        legend: {\n            layout: 'vertical',\n            align: 'right',\n            verticalAlign: 'middle',\n            borderWidth: 1\n        },\n        series: data.series\n\n    } ));\n\n}\n\nfunction updateViewType ( index ) {\n\n    $( \"#scrollBed\" ).css( 'marginLeft', -index*324+'px' );\n\n}\n\nfunction collectData () {\n\n    var form = document.forms[ 'data-form' ],\n        data = null;\n\n    if ( currentChartType !== chartsConfig.length - 1 ) {\n\n        data = getSeriesAndCategories();\n        $.extend( data, getUserConfig() );\n\n    //饼图数据格式\n    } else {\n        data = getSeriesForPieChart();\n        data.title = form[ 'title' ].value;\n        data.suffix = form[ 'unit' ].value;\n    }\n\n    return data;\n\n}\n\n/**\n * 获取用户配置信息\n */\nfunction getUserConfig () {\n\n    var form = document.forms[ 'data-form' ],\n        info = {\n            title: form[ 'title' ].value,\n            subTitle: form[ 'sub-title' ].value,\n            xTitle: form[ 'x-title' ].value,\n            yTitle: form[ 'y-title' ].value,\n            suffix: form[ 'unit' ].value,\n            //数据对齐方式\n            tableDataFormat: getTableDataFormat (),\n            //饼图提示文字\n            tip: $( \"#tipInput\" ).val()\n        };\n\n    return info;\n\n}\n\nfunction setUserConfig ( config ) {\n\n    var form = document.forms[ 'data-form' ];\n\n    config.title && ( form[ 'title' ].value = config.title );\n    config.subTitle && ( form[ 'sub-title' ].value = config.subTitle );\n    config.xTitle && ( form[ 'x-title' ].value = config.xTitle );\n    config.yTitle && ( form[ 'y-title' ].value = config.yTitle );\n    config.suffix && ( form[ 'unit' ].value = config.suffix );\n    config.dataFormat == \"-1\" && ( form[ 'charts-format' ][ 1 ].checked = true );\n    config.tip && ( form[ 'tip' ].value = config.tip );\n    currentChartType = config.chartType || 0;\n\n}\n\nfunction getSeriesAndCategories () {\n\n    var form = document.forms[ 'data-form' ],\n        series = [],\n        categories = [],\n        tmp = [],\n        tableData = getTableData();\n\n    //反转数据\n    if ( getTableDataFormat() === \"-1\" ) {\n\n        for ( var i = 0, len = tableData.length; i < len; i++ ) {\n\n            for ( var j = 0, jlen = tableData[ i ].length; j < jlen; j++ ) {\n\n                if ( !tmp[ j ] ) {\n                    tmp[ j ] = [];\n                }\n\n                tmp[ j ][ i ] = tableData[ i ][ j ];\n\n            }\n\n        }\n\n        tableData = tmp;\n\n    }\n\n    categories = tableData[0].slice( 1 );\n\n    for ( var i = 1, data; data = tableData[ i ]; i++ ) {\n\n        series.push( {\n            name: data[ 0 ],\n            data: data.slice( 1 )\n        } );\n\n    }\n\n    return {\n        series: series,\n        categories: categories\n    };\n\n}\n\n/*\n * 获取数据源数据对齐方式\n */\nfunction getTableDataFormat () {\n\n    var form = document.forms[ 'data-form' ],\n        items = form['charts-format'];\n\n    return items[ 0 ].checked ? items[ 0 ].value : items[ 1 ].value;\n\n}\n\n/*\n * 禁用非饼图类型的配置项\n */\nfunction disableNotPieConfig() {\n\n    updateConfigItem( 'disable' );\n\n}\n\n/*\n * 启用非饼图类型的配置项\n */\nfunction enableNotPieConfig() {\n\n    updateConfigItem( 'enable' );\n\n}\n\nfunction updateConfigItem ( value ) {\n\n    var table = $( \"#showTable\" )[ 0 ],\n        isDisable = value === 'disable' ? true : false;\n\n    //table中的input处理\n    for ( var i = 2 , row; row = table.rows[ i ]; i++ ) {\n\n        for ( var j = 1, cell; cell = row.cells[ j ]; j++ ) {\n\n            $( \"input\", cell ).attr( \"disabled\", isDisable );\n\n        }\n\n    }\n\n    //其他项处理\n    $( \"input.not-pie-item\" ).attr( \"disabled\", isDisable );\n    $( \"#tipInput\" ).attr( \"disabled\", !isDisable )\n\n}\n\n/*\n * 获取饼图数据\n * 饼图的数据只取第一行的\n **/\nfunction getSeriesForPieChart () {\n\n    var series = {\n            type: 'pie',\n            name: $(\"#tipInput\").val(),\n            data: []\n        },\n        tableData = getTableData();\n\n\n    for ( var j = 1, jlen = tableData[ 0 ].length; j < jlen; j++ ) {\n\n        var title = tableData[ 0 ][ j ],\n            val = tableData[ 1 ][ j ];\n\n        series.data.push( [ title, val ] );\n\n    }\n\n    return {\n        series: [ series ]\n    };\n\n}\n\nfunction getTableData () {\n\n    var table = document.getElementById( \"showTable\" ),\n        xCount = table.rows[0].cells.length - 1,\n        values = getTableInputValue();\n\n    for ( var i = 0, value; value = values[ i ]; i++ ) {\n\n        tableData[ Math.floor( i / xCount ) + 1 ][ i % xCount + 1 ] = values[ i ];\n\n    }\n\n    return tableData;\n\n}\n\nfunction getTableInputValue () {\n\n    var table = document.getElementById( \"showTable\" ),\n        inputs = table.getElementsByTagName( \"input\" ),\n        values = [];\n\n    for ( var i = 0, input; input = inputs[ i ]; i++ ) {\n        values.push( input.value | 0 );\n    }\n\n    return values;\n\n}\n\nfunction getCellValue ( cell ) {\n\n    var value = utils.trim( ( cell.innerText || cell.textContent || '' ) );\n\n    return value.replace( new RegExp( UE.dom.domUtils.fillChar, 'g' ), '' ).replace( /^\\s+|\\s+$/g, '' );\n\n}\n\n\n//dialog确认事件\ndialog.onok = function () {\n\n    //收集信息\n    var form = document.forms[ 'data-form' ],\n        info = getUserConfig();\n\n    //添加图表类型\n    info.chartType = currentChartType;\n\n    //同步表格数据到编辑器\n    syncTableData();\n\n    //执行图表命令\n    editor.execCommand( 'charts', info );\n\n};\n\n/*\n * 同步图表编辑视图的表格数据到编辑器里的原始表格\n */\nfunction syncTableData () {\n\n    var tableData = getTableData();\n\n    for ( var i = 1, row; row = editorTable.rows[ i ]; i++ ) {\n\n        for ( var j = 1, cell; cell = row.cells[ j ]; j++ ) {\n\n            cell.innerHTML = tableData[ i ] [ j ];\n\n        }\n\n    }\n\n}"]}