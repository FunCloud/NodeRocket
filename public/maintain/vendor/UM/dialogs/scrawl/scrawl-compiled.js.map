{"version":3,"sources":["scrawl.js"],"names":[],"mappings":"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","file":"scrawl-compiled.js","sourcesContent":["/**\r\n * Created with JetBrains PhpStorm.\r\n * User: xuheng\r\n * Date: 12-5-22\r\n * Time: 上午11:38\r\n * To change this template use File | Settings | File Templates.\r\n */\r\nvar scrawl = function (options) {\r\n    options && this.initOptions(options);\r\n};\r\n(function () {\r\n    var canvas = $G(\"J_brushBoard\"),\r\n        context = canvas.getContext('2d'),\r\n        drawStep = [], //undo redo存储\r\n        drawStepIndex = 0; //undo redo指针\r\n\r\n    scrawl.prototype = {\r\n        isScrawl:false, //是否涂鸦\r\n        brushWidth:-1, //画笔粗细\r\n        brushColor:\"\", //画笔颜色\r\n\r\n        initOptions:function (options) {\r\n            var me = this;\r\n            me.originalState(options);//初始页面状态\r\n            me._buildToolbarColor(options.colorList);//动态生成颜色选择集合\r\n\r\n            me._addBoardListener(options.saveNum);//添加画板处理\r\n            me._addOPerateListener(options.saveNum);//添加undo redo clearBoard处理\r\n            me._addColorBarListener();//添加颜色选择处理\r\n            me._addBrushBarListener();//添加画笔大小处理\r\n            me._addEraserBarListener();//添加橡皮大小处理\r\n            me._addAddImgListener();//添加增添背景图片处理\r\n            me._addRemoveImgListenter();//删除背景图片处理\r\n            me._addScalePicListenter();//添加缩放处理\r\n            me._addClearSelectionListenter();//添加清楚选中状态处理\r\n\r\n            me._originalColorSelect(options.drawBrushColor);//初始化颜色选中\r\n            me._originalBrushSelect(options.drawBrushSize);//初始化画笔选中\r\n            me._clearSelection();//清楚选中状态\r\n        },\r\n\r\n        originalState:function (options) {\r\n            var me = this;\r\n\r\n            me.brushWidth = options.drawBrushSize;//同步画笔粗细\r\n            me.brushColor = options.drawBrushColor;//同步画笔颜色\r\n\r\n            context.lineWidth = me.brushWidth;//初始画笔大小\r\n            context.strokeStyle = me.brushColor;//初始画笔颜色\r\n            context.fillStyle = \"transparent\";//初始画布背景颜色\r\n            context.lineCap = \"round\";//去除锯齿\r\n            context.fill();\r\n        },\r\n        _buildToolbarColor:function (colorList) {\r\n            var tmp = null, arr = [];\r\n            arr.push(\"<table id='J_colorList'>\");\r\n            for (var i = 0, color; color = colorList[i++];) {\r\n                if ((i - 1) % 5 == 0) {\r\n                    if (i != 1) {\r\n                        arr.push(\"</tr>\");\r\n                    }\r\n                    arr.push(\"<tr>\");\r\n                }\r\n                tmp = '#' + color;\r\n                arr.push(\"<td><a title='\" + tmp + \"' href='javascript:void(0)' style='background-color:\" + tmp + \"'></a></td>\");\r\n            }\r\n            arr.push(\"</tr></table>\");\r\n            $G(\"J_colorBar\").innerHTML = arr.join(\"\");\r\n        },\r\n\r\n        _addBoardListener:function (saveNum) {\r\n            var me = this,\r\n                margin = 0,\r\n                startX = -1,\r\n                startY = -1,\r\n                isMouseDown = false,\r\n                isMouseMove = false,\r\n                isMouseUp = false,\r\n                buttonPress = 0, button, flag = '';\r\n\r\n            margin = parseInt(domUtils.getComputedStyle($G(\"J_wrap\"), \"margin-left\"));\r\n            drawStep.push(context.getImageData(0, 0, context.canvas.width, context.canvas.height));\r\n            drawStepIndex += 1;\r\n\r\n            domUtils.on(canvas, [\"mousedown\", \"mousemove\", \"mouseup\", \"mouseout\"], function (e) {\r\n                button = browser.webkit ? e.which : buttonPress;\r\n                switch (e.type) {\r\n                    case 'mousedown':\r\n                        buttonPress = 1;\r\n                        flag = 1;\r\n                        isMouseDown = true;\r\n                        isMouseUp = false;\r\n                        isMouseMove = false;\r\n                        me.isScrawl = true;\r\n                        startX = e.clientX - margin;//10为外边距总和\r\n                        startY = e.clientY - margin;\r\n                        context.beginPath();\r\n                        break;\r\n                    case 'mousemove' :\r\n                        if (!flag && button == 0) {\r\n                            return;\r\n                        }\r\n                        if (!flag && button) {\r\n                            startX = e.clientX - margin;//10为外边距总和\r\n                            startY = e.clientY - margin;\r\n                            context.beginPath();\r\n                            flag = 1;\r\n                        }\r\n                        if (isMouseUp || !isMouseDown) {\r\n                            return;\r\n                        }\r\n                        var endX = e.clientX - margin,\r\n                            endY = e.clientY - margin;\r\n\r\n                        context.moveTo(startX, startY);\r\n                        context.lineTo(endX, endY);\r\n                        context.stroke();\r\n                        startX = endX;\r\n                        startY = endY;\r\n                        isMouseMove = true;\r\n                        break;\r\n                    case 'mouseup':\r\n                        buttonPress = 0;\r\n                        if (!isMouseDown)return;\r\n                        if (!isMouseMove) {\r\n                            context.arc(startX, startY, context.lineWidth, 0, Math.PI * 2, false);\r\n                            context.fillStyle = context.strokeStyle;\r\n                            context.fill();\r\n                        }\r\n                        context.closePath();\r\n                        me._saveOPerate(saveNum);\r\n                        isMouseDown = false;\r\n                        isMouseMove = false;\r\n                        isMouseUp = true;\r\n                        startX = -1;\r\n                        startY = -1;\r\n                        break;\r\n                    case 'mouseout':\r\n                        flag = '';\r\n                        buttonPress = 0;\r\n                        if (button == 1) return;\r\n                        context.closePath();\r\n                        break;\r\n                }\r\n            });\r\n        },\r\n        _addOPerateListener:function (saveNum) {\r\n            var me = this;\r\n            domUtils.on($G(\"J_previousStep\"), \"click\", function () {\r\n                if (drawStepIndex > 1) {\r\n                    drawStepIndex -= 1;\r\n                    context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n                    context.putImageData(drawStep[drawStepIndex - 1], 0, 0);\r\n                    me.btn2Highlight(\"J_nextStep\");\r\n                    drawStepIndex == 1 && me.btn2disable(\"J_previousStep\");\r\n                }\r\n            });\r\n            domUtils.on($G(\"J_nextStep\"), \"click\", function () {\r\n                if (drawStepIndex > 0 && drawStepIndex < drawStep.length) {\r\n                    context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n                    context.putImageData(drawStep[drawStepIndex], 0, 0);\r\n                    drawStepIndex += 1;\r\n                    me.btn2Highlight(\"J_previousStep\");\r\n                    drawStepIndex == drawStep.length && me.btn2disable(\"J_nextStep\");\r\n                }\r\n            });\r\n            domUtils.on($G(\"J_clearBoard\"), \"click\", function () {\r\n                context.clearRect(0, 0, context.canvas.width, context.canvas.height);\r\n                drawStep = [];\r\n                me._saveOPerate(saveNum);\r\n                drawStepIndex = 1;\r\n                me.isScrawl = false;\r\n                me.btn2disable(\"J_previousStep\");\r\n                me.btn2disable(\"J_nextStep\");\r\n                me.btn2disable(\"J_clearBoard\");\r\n            });\r\n        },\r\n        _addColorBarListener:function () {\r\n            var me = this;\r\n            domUtils.on($G(\"J_colorBar\"), \"click\", function (e) {\r\n                var target = me.getTarget(e),\r\n                    color = target.title;\r\n                if (!!color) {\r\n                    me._addColorSelect(target);\r\n\r\n                    me.brushColor = color;\r\n                    context.globalCompositeOperation = \"source-over\";\r\n                    context.lineWidth = me.brushWidth;\r\n                    context.strokeStyle = color;\r\n                }\r\n            });\r\n        },\r\n        _addBrushBarListener:function () {\r\n            var me = this;\r\n            domUtils.on($G(\"J_brushBar\"), \"click\", function (e) {\r\n                var target = me.getTarget(e),\r\n                    size = browser.ie ? target.innerText : target.text;\r\n                if (!!size) {\r\n                    me._addBESelect(target);\r\n\r\n                    context.globalCompositeOperation = \"source-over\";\r\n                    context.lineWidth = parseInt(size);\r\n                    context.strokeStyle = me.brushColor;\r\n                    me.brushWidth = context.lineWidth;\r\n                }\r\n            });\r\n        },\r\n        _addEraserBarListener:function () {\r\n            var me = this;\r\n            domUtils.on($G(\"J_eraserBar\"), \"click\", function (e) {\r\n                var target = me.getTarget(e),\r\n                    size = browser.ie ? target.innerText : target.text;\r\n                if (!!size) {\r\n                    me._addBESelect(target);\r\n\r\n                    context.lineWidth = parseInt(size);\r\n                    context.globalCompositeOperation = \"destination-out\";\r\n                    context.strokeStyle = \"#FFF\";\r\n                }\r\n            });\r\n        },\r\n        _addAddImgListener:function () {\r\n            var file = $G(\"J_imgTxt\");\r\n            if (!window.FileReader) {\r\n                $G(\"J_addImg\").style.display = 'none';\r\n                $G(\"J_removeImg\").style.display = 'none';\r\n                $G(\"J_sacleBoard\").style.display = 'none';\r\n            }\r\n            domUtils.on(file, \"change\", function (e) {\r\n                var frm = file.parentNode;\r\n                addMaskLayer(lang.backgroundUploading);\r\n\r\n                var target = e.target || e.srcElement,\r\n                    reader = new FileReader();\r\n                reader.onload = function(evt){\r\n                    var target = evt.target || evt.srcElement;\r\n                    ue_callback(target.result, 'SUCCESS');\r\n                };\r\n                reader.readAsDataURL(target.files[0]);\r\n                frm.reset();\r\n            });\r\n        },\r\n        _addRemoveImgListenter:function () {\r\n            var me = this;\r\n            domUtils.on($G(\"J_removeImg\"), \"click\", function () {\r\n                $G(\"J_picBoard\").innerHTML = \"\";\r\n                me.btn2disable(\"J_removeImg\");\r\n                me.btn2disable(\"J_sacleBoard\");\r\n            });\r\n        },\r\n        _addScalePicListenter:function () {\r\n            domUtils.on($G(\"J_sacleBoard\"), \"click\", function () {\r\n                var picBoard = $G(\"J_picBoard\"),\r\n                    scaleCon = $G(\"J_scaleCon\"),\r\n                    img = picBoard.children[0];\r\n\r\n                if (img) {\r\n                    if (!scaleCon) {\r\n                        picBoard.style.cssText = \"position:relative;z-index:999;\"+picBoard.style.cssText;\r\n                        img.style.cssText = \"position: absolute;top:\" + (canvas.height - img.height) / 2 + \"px;left:\" + (canvas.width - img.width) / 2 + \"px;\";\r\n                        var scale = new ScaleBoy();\r\n                        picBoard.appendChild(scale.init());\r\n                        scale.startScale(img);\r\n                    } else {\r\n                        if (scaleCon.style.visibility == \"visible\") {\r\n                            scaleCon.style.visibility = \"hidden\";\r\n                            picBoard.style.position = \"\";\r\n                            picBoard.style.zIndex = \"\";\r\n                        } else {\r\n                            scaleCon.style.visibility = \"visible\";\r\n                            picBoard.style.cssText += \"position:relative;z-index:999\";\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        _addClearSelectionListenter:function () {\r\n            var doc = document;\r\n            domUtils.on(doc, 'mousemove', function (e) {\r\n                if (browser.ie && browser.version < 11)\r\n                    doc.selection.clear();\r\n                else\r\n                    window.getSelection().removeAllRanges();\r\n            });\r\n        },\r\n        _clearSelection:function () {\r\n            var list = [\"J_operateBar\", \"J_colorBar\", \"J_brushBar\", \"J_eraserBar\", \"J_picBoard\"];\r\n            for (var i = 0, group; group = list[i++];) {\r\n                domUtils.unSelectable($G(group));\r\n            }\r\n        },\r\n\r\n        _saveOPerate:function (saveNum) {\r\n            var me = this;\r\n            if (drawStep.length <= saveNum) {\r\n                if(drawStepIndex<drawStep.length){\r\n                    me.btn2disable(\"J_nextStep\");\r\n                    drawStep.splice(drawStepIndex);\r\n                }\r\n                drawStep.push(context.getImageData(0, 0, context.canvas.width, context.canvas.height));\r\n                drawStepIndex = drawStep.length;\r\n            } else {\r\n                drawStep.shift();\r\n                drawStep.push(context.getImageData(0, 0, context.canvas.width, context.canvas.height));\r\n                drawStepIndex = drawStep.length;\r\n            }\r\n            me.btn2Highlight(\"J_previousStep\");\r\n            me.btn2Highlight(\"J_clearBoard\");\r\n        },\r\n\r\n        _originalColorSelect:function (title) {\r\n            var colorList = $G(\"J_colorList\").getElementsByTagName(\"td\");\r\n            for (var j = 0, cell; cell = colorList[j++];) {\r\n                if (cell.children[0].title.toLowerCase() == title) {\r\n                    cell.children[0].style.opacity = 1;\r\n                }\r\n            }\r\n        },\r\n        _originalBrushSelect:function (text) {\r\n            var brushList = $G(\"J_brushBar\").children;\r\n            for (var i = 0, ele; ele = brushList[i++];) {\r\n                if (ele.tagName.toLowerCase() == \"a\") {\r\n                    var size = browser.ie ? ele.innerText : ele.text;\r\n                    if (size.toLowerCase() == text) {\r\n                        ele.style.opacity = 1;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        _addColorSelect:function (target) {\r\n            var me = this,\r\n                colorList = $G(\"J_colorList\").getElementsByTagName(\"td\"),\r\n                eraserList = $G(\"J_eraserBar\").children,\r\n                brushList = $G(\"J_brushBar\").children;\r\n\r\n            for (var i = 0, cell; cell = colorList[i++];) {\r\n                cell.children[0].style.opacity = 0.3;\r\n            }\r\n            for (var k = 0, ele; ele = brushList[k++];) {\r\n                if (ele.tagName.toLowerCase() == \"a\") {\r\n                    ele.style.opacity = 0.3;\r\n                    var size = browser.ie ? ele.innerText : ele.text;\r\n                    if (size.toLowerCase() == this.brushWidth) {\r\n                        ele.style.opacity = 1;\r\n                    }\r\n                }\r\n            }\r\n            for (var j = 0, node; node = eraserList[j++];) {\r\n                if (node.tagName.toLowerCase() == \"a\") {\r\n                    node.style.opacity = 0.3;\r\n                }\r\n            }\r\n\r\n            target.style.opacity = 1;\r\n            target.blur();\r\n        },\r\n        _addBESelect:function (target) {\r\n            var brushList = $G(\"J_brushBar\").children;\r\n            var eraserList = $G(\"J_eraserBar\").children;\r\n\r\n            for (var i = 0, ele; ele = brushList[i++];) {\r\n                if (ele.tagName.toLowerCase() == \"a\") {\r\n                    ele.style.opacity = 0.3;\r\n                }\r\n            }\r\n            for (var j = 0, node; node = eraserList[j++];) {\r\n                if (node.tagName.toLowerCase() == \"a\") {\r\n                    node.style.opacity = 0.3;\r\n                }\r\n            }\r\n\r\n            target.style.opacity = 1;\r\n            target.blur();\r\n        },\r\n        getCanvasData:function () {\r\n            var picContainer = $G(\"J_picBoard\"),\r\n                img = picContainer.children[0];\r\n            if (img) {\r\n                var x, y;\r\n                if (img.style.position == \"absolute\") {\r\n                    x = parseInt(img.style.left);\r\n                    y = parseInt(img.style.top);\r\n                } else {\r\n                    x = (picContainer.offsetWidth - img.width) / 2;\r\n                    y = (picContainer.offsetHeight - img.height) / 2;\r\n                }\r\n                context.globalCompositeOperation = \"destination-over\";\r\n                context.drawImage(img, x, y, img.width, img.height);\r\n            } else {\r\n                context.globalCompositeOperation = \"destination-atop\";\r\n                context.fillStyle = \"#fff\";//重置画布背景白色\r\n                context.fillRect(0, 0, canvas.width, canvas.height);\r\n            }\r\n            try {\r\n                return canvas.toDataURL(\"image/png\").substring(22);\r\n            } catch (e) {\r\n                return \"\";\r\n            }\r\n        },\r\n        btn2Highlight:function (id) {\r\n            var cur = $G(id);\r\n            cur.className.indexOf(\"H\") == -1 && (cur.className += \"H\");\r\n        },\r\n        btn2disable:function (id) {\r\n            var cur = $G(id);\r\n            cur.className.indexOf(\"H\") != -1 && (cur.className = cur.className.replace(\"H\", \"\"));\r\n        },\r\n        getTarget:function (evt) {\r\n            return evt.target || evt.srcElement;\r\n        }\r\n    };\r\n})();\r\n\r\nvar ScaleBoy = function () {\r\n    this.dom = null;\r\n    this.scalingElement = null;\r\n};\r\n(function () {\r\n    function _appendStyle() {\r\n        var doc = document,\r\n            head = doc.getElementsByTagName('head')[0],\r\n            style = doc.createElement('style'),\r\n            cssText = '.scale{visibility:hidden;cursor:move;position:absolute;left:0;top:0;width:100px;height:50px;background-color:#fff;font-size:0;line-height:0;opacity:.4;filter:Alpha(opacity=40);}'\r\n                + '.scale span{position:absolute;left:0;top:0;width:6px;height:6px;background-color:#006DAE;}'\r\n                + '.scale .hand0, .scale .hand7{cursor:nw-resize;}'\r\n                + '.scale .hand1, .scale .hand6{left:50%;margin-left:-3px;cursor:n-resize;}'\r\n                + '.scale .hand2, .scale .hand4, .scale .hand7{left:100%;margin-left:-6px;}'\r\n                + '.scale .hand3, .scale .hand4{top:50%;margin-top:-3px;cursor:w-resize;}'\r\n                + '.scale .hand5, .scale .hand6, .scale .hand7{margin-top:-6px;top:100%;}'\r\n                + '.scale .hand2, .scale .hand5{cursor:ne-resize;}';\r\n        style.type = 'text/css';\r\n\r\n        try {\r\n            style.appendChild(doc.createTextNode(cssText));\r\n        } catch (e) {\r\n            style.styleSheet.cssText = cssText;\r\n        }\r\n        head.appendChild(style);\r\n    }\r\n\r\n    function _getDom() {\r\n        var doc = document,\r\n            hand,\r\n            arr = [],\r\n            scale = doc.createElement('div');\r\n\r\n        scale.id = 'J_scaleCon';\r\n        scale.className = 'scale';\r\n        for (var i = 0; i < 8; i++) {\r\n            arr.push(\"<span class='hand\" + i + \"'></span>\");\r\n        }\r\n        scale.innerHTML = arr.join(\"\");\r\n        return scale;\r\n    }\r\n\r\n    var rect = [\r\n        //[left, top, width, height]\r\n        [1, 1, -1, -1],\r\n        [0, 1, 0, -1],\r\n        [0, 1, 1, -1],\r\n        [1, 0, -1, 0],\r\n        [0, 0, 1, 0],\r\n        [1, 0, -1, 1],\r\n        [0, 0, 0, 1],\r\n        [0, 0, 1, 1]\r\n    ];\r\n    ScaleBoy.prototype = {\r\n        init:function () {\r\n            _appendStyle();\r\n            var me = this,\r\n                scale = me.dom = _getDom();\r\n\r\n            me.scaleMousemove.fp = me;\r\n            domUtils.on(scale, 'mousedown', function (e) {\r\n                var target = e.target || e.srcElement;\r\n                me.start = {x:e.clientX, y:e.clientY};\r\n                if (target.className.indexOf('hand') != -1) {\r\n                    me.dir = target.className.replace('hand', '');\r\n                }\r\n                domUtils.on(document.body, 'mousemove', me.scaleMousemove);\r\n                e.stopPropagation ? e.stopPropagation() : e.cancelBubble = true;\r\n            });\r\n            domUtils.on(document.body, 'mouseup', function (e) {\r\n                if (me.start) {\r\n                    domUtils.un(document.body, 'mousemove', me.scaleMousemove);\r\n                    if (me.moved) {\r\n                        me.updateScaledElement({position:{x:scale.style.left, y:scale.style.top}, size:{w:scale.style.width, h:scale.style.height}});\r\n                    }\r\n                    delete me.start;\r\n                    delete me.moved;\r\n                    delete me.dir;\r\n                }\r\n            });\r\n            return scale;\r\n        },\r\n        startScale:function (objElement) {\r\n            var me = this, Idom = me.dom;\r\n\r\n            Idom.style.cssText = 'visibility:visible;top:' + objElement.style.top + ';left:' + objElement.style.left + ';width:' + objElement.offsetWidth + 'px;height:' + objElement.offsetHeight + 'px;';\r\n            me.scalingElement = objElement;\r\n        },\r\n        updateScaledElement:function (objStyle) {\r\n            var cur = this.scalingElement,\r\n                pos = objStyle.position,\r\n                size = objStyle.size;\r\n            if (pos) {\r\n                typeof pos.x != 'undefined' && (cur.style.left = pos.x);\r\n                typeof pos.y != 'undefined' && (cur.style.top = pos.y);\r\n            }\r\n            if (size) {\r\n                size.w && (cur.style.width = size.w);\r\n                size.h && (cur.style.height = size.h);\r\n            }\r\n        },\r\n        updateStyleByDir:function (dir, offset) {\r\n            var me = this,\r\n                dom = me.dom, tmp;\r\n\r\n            rect['def'] = [1, 1, 0, 0];\r\n            if (rect[dir][0] != 0) {\r\n                tmp = parseInt(dom.style.left) + offset.x;\r\n                dom.style.left = me._validScaledProp('left', tmp) + 'px';\r\n            }\r\n            if (rect[dir][1] != 0) {\r\n                tmp = parseInt(dom.style.top) + offset.y;\r\n                dom.style.top = me._validScaledProp('top', tmp) + 'px';\r\n            }\r\n            if (rect[dir][2] != 0) {\r\n                tmp = dom.clientWidth + rect[dir][2] * offset.x;\r\n                dom.style.width = me._validScaledProp('width', tmp) + 'px';\r\n            }\r\n            if (rect[dir][3] != 0) {\r\n                tmp = dom.clientHeight + rect[dir][3] * offset.y;\r\n                dom.style.height = me._validScaledProp('height', tmp) + 'px';\r\n            }\r\n            if (dir === 'def') {\r\n                me.updateScaledElement({position:{x:dom.style.left, y:dom.style.top}});\r\n            }\r\n        },\r\n        scaleMousemove:function (e) {\r\n            var me = arguments.callee.fp,\r\n                start = me.start,\r\n                dir = me.dir || 'def',\r\n                offset = {x:e.clientX - start.x, y:e.clientY - start.y};\r\n\r\n            me.updateStyleByDir(dir, offset);\r\n            arguments.callee.fp.start = {x:e.clientX, y:e.clientY};\r\n            arguments.callee.fp.moved = 1;\r\n        },\r\n        _validScaledProp:function (prop, value) {\r\n            var ele = this.dom,\r\n                wrap = $G(\"J_picBoard\");\r\n\r\n            value = isNaN(value) ? 0 : value;\r\n            switch (prop) {\r\n                case 'left':\r\n                    return value < 0 ? 0 : (value + ele.clientWidth) > wrap.clientWidth ? wrap.clientWidth - ele.clientWidth : value;\r\n                case 'top':\r\n                    return value < 0 ? 0 : (value + ele.clientHeight) > wrap.clientHeight ? wrap.clientHeight - ele.clientHeight : value;\r\n                case 'width':\r\n                    return value <= 0 ? 1 : (value + ele.offsetLeft) > wrap.clientWidth ? wrap.clientWidth - ele.offsetLeft : value;\r\n                case 'height':\r\n                    return value <= 0 ? 1 : (value + ele.offsetTop) > wrap.clientHeight ? wrap.clientHeight - ele.offsetTop : value;\r\n            }\r\n        }\r\n    };\r\n})();\r\n\r\n//后台回调\r\nfunction ue_callback(url, state) {\r\n    var doc = document,\r\n        picBorard = $G(\"J_picBoard\"),\r\n        img = doc.createElement(\"img\");\r\n\r\n    //图片缩放\r\n    function scale(img, max, oWidth, oHeight) {\r\n        var width = 0, height = 0, percent, ow = img.width || oWidth, oh = img.height || oHeight;\r\n        if (ow > max || oh > max) {\r\n            if (ow >= oh) {\r\n                if (width = ow - max) {\r\n                    percent = (width / ow).toFixed(2);\r\n                    img.height = oh - oh * percent;\r\n                    img.width = max;\r\n                }\r\n            } else {\r\n                if (height = oh - max) {\r\n                    percent = (height / oh).toFixed(2);\r\n                    img.width = ow - ow * percent;\r\n                    img.height = max;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //移除遮罩层\r\n    removeMaskLayer();\r\n    //状态响应\r\n    if (state == \"SUCCESS\") {\r\n        picBorard.innerHTML = \"\";\r\n        img.onload = function () {\r\n            scale(this, 300);\r\n            picBorard.appendChild(img);\r\n\r\n            var obj = new scrawl();\r\n            obj.btn2Highlight(\"J_removeImg\");\r\n            //trace 2457\r\n            obj.btn2Highlight(\"J_sacleBoard\");\r\n        };\r\n        img.src = url;\r\n    } else {\r\n        alert(state);\r\n    }\r\n}\r\n//去掉遮罩层\r\nfunction removeMaskLayer() {\r\n    var maskLayer = $G(\"J_maskLayer\");\r\n    maskLayer.className = \"maskLayerNull\";\r\n    maskLayer.innerHTML = \"\";\r\n    dialog.buttons[0].setDisabled(false);\r\n}\r\n//添加遮罩层\r\nfunction addMaskLayer(html) {\r\n    var maskLayer = $G(\"J_maskLayer\");\r\n    dialog.buttons[0].setDisabled(true);\r\n    maskLayer.className = \"maskLayer\";\r\n    maskLayer.innerHTML = html;\r\n}\r\n//执行确认按钮方法\r\nfunction exec(scrawlObj) {\r\n    if (scrawlObj.isScrawl) {\r\n        addMaskLayer(lang.scrawlUpLoading);\r\n        var base64 = scrawlObj.getCanvasData();\r\n        if (!!base64) {\r\n            var options = {\r\n                timeout:100000,\r\n                onsuccess:function (xhr) {\r\n                    if (!scrawlObj.isCancelScrawl) {\r\n                        var responseObj;\r\n                        responseObj = eval(\"(\" + xhr.responseText + \")\");\r\n                        if (responseObj.state == \"SUCCESS\") {\r\n                            var imgObj = {},\r\n                                url = editor.options.scrawlUrlPrefix + responseObj.url;\r\n                            imgObj.src = url;\r\n                            imgObj._src = url;\r\n                            imgObj.alt = responseObj.original || '';\r\n                            imgObj.title = responseObj.title || '';\r\n                            editor.execCommand(\"insertImage\", imgObj);\r\n                            dialog.close();\r\n                        } else {\r\n                            alert(responseObj.state);\r\n                        }\r\n\r\n                    }\r\n                },\r\n                onerror:function () {\r\n                    alert(lang.imageError);\r\n                    dialog.close();\r\n                }\r\n            };\r\n            options[editor.getOpt('scrawlFieldName')] = base64;\r\n\r\n            var actionUrl = editor.getActionUrl(editor.getOpt('scrawlActionName')),\r\n                params = utils.serializeParam(editor.queryCommandValue('serverparam')) || '',\r\n                url = utils.formatUrl(actionUrl + (actionUrl.indexOf('?') == -1 ? '?':'&') + params);\r\n            ajax.request(url, options);\r\n        }\r\n    } else {\r\n        addMaskLayer(lang.noScarwl + \"&nbsp;&nbsp;&nbsp;<input type='button' value='\" + lang.continueBtn + \"'  onclick='removeMaskLayer()'/>\");\r\n    }\r\n}\r\n\r\n"]}