{"version":3,"sources":["video.js"],"names":[],"mappings":"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","file":"video-compiled.js","sourcesContent":["/**\r\n * Created by JetBrains PhpStorm.\r\n * User: taoqili\r\n * Date: 12-2-20\r\n * Time: 上午11:19\r\n * To change this template use File | Settings | File Templates.\r\n */\r\n\r\n(function(){\r\n\r\n    var video = {},\r\n        uploadVideoList = [],\r\n        isModifyUploadVideo = false,\r\n        uploadFile;\r\n\r\n    window.onload = function(){\r\n        $focus($G(\"videoUrl\"));\r\n        initTabs();\r\n        initVideo();\r\n        initUpload();\r\n    };\r\n\r\n    /* 初始化tab标签 */\r\n    function initTabs(){\r\n        var tabs = $G('tabHeads').children;\r\n        for (var i = 0; i < tabs.length; i++) {\r\n            domUtils.on(tabs[i], \"click\", function (e) {\r\n                var j, bodyId, target = e.target || e.srcElement;\r\n                for (j = 0; j < tabs.length; j++) {\r\n                    bodyId = tabs[j].getAttribute('data-content-id');\r\n                    if(tabs[j] == target){\r\n                        domUtils.addClass(tabs[j], 'focus');\r\n                        domUtils.addClass($G(bodyId), 'focus');\r\n                    }else {\r\n                        domUtils.removeClasses(tabs[j], 'focus');\r\n                        domUtils.removeClasses($G(bodyId), 'focus');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    function initVideo(){\r\n        createAlignButton( [\"videoFloat\", \"upload_alignment\"] );\r\n        addUrlChangeListener($G(\"videoUrl\"));\r\n        addOkListener();\r\n\r\n        //编辑视频时初始化相关信息\r\n        (function(){\r\n            var img = editor.selection.getRange().getClosedNode(),url;\r\n            if(img && img.className){\r\n                var hasFakedClass = (img.className == \"edui-faked-video\"),\r\n                    hasUploadClass = img.className.indexOf(\"edui-upload-video\")!=-1;\r\n                if(hasFakedClass || hasUploadClass) {\r\n                    $G(\"videoUrl\").value = url = img.getAttribute(\"_url\");\r\n                    $G(\"videoWidth\").value = img.width;\r\n                    $G(\"videoHeight\").value = img.height;\r\n                    var align = domUtils.getComputedStyle(img,\"float\"),\r\n                        parentAlign = domUtils.getComputedStyle(img.parentNode,\"text-align\");\r\n                    updateAlignButton(parentAlign===\"center\"?\"center\":align);\r\n                }\r\n                if(hasUploadClass) {\r\n                    isModifyUploadVideo = true;\r\n                }\r\n            }\r\n            createPreviewVideo(url);\r\n        })();\r\n    }\r\n\r\n    /**\r\n     * 监听确认和取消两个按钮事件，用户执行插入或者清空正在播放的视频实例操作\r\n     */\r\n    function addOkListener(){\r\n        dialog.onok = function(){\r\n            $G(\"preview\").innerHTML = \"\";\r\n            var currentTab =  findFocus(\"tabHeads\",\"tabSrc\");\r\n            switch(currentTab){\r\n                case \"video\":\r\n                    return insertSingle();\r\n                    break;\r\n                case \"videoSearch\":\r\n                    return insertSearch(\"searchList\");\r\n                    break;\r\n                case \"upload\":\r\n                    return insertUpload();\r\n                    break;\r\n            }\r\n        };\r\n        dialog.oncancel = function(){\r\n            $G(\"preview\").innerHTML = \"\";\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 依据传入的align值更新按钮信息\r\n     * @param align\r\n     */\r\n    function updateAlignButton( align ) {\r\n        var aligns = $G( \"videoFloat\" ).children;\r\n        for ( var i = 0, ci; ci = aligns[i++]; ) {\r\n            if ( ci.getAttribute( \"name\" ) == align ) {\r\n                if ( ci.className !=\"focus\" ) {\r\n                    ci.className = \"focus\";\r\n                }\r\n            } else {\r\n                if ( ci.className ==\"focus\" ) {\r\n                    ci.className = \"\";\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 将单个视频信息插入编辑器中\r\n     */\r\n    function insertSingle(){\r\n        var width = $G(\"videoWidth\"),\r\n            height = $G(\"videoHeight\"),\r\n            url=$G('videoUrl').value,\r\n            align = findFocus(\"videoFloat\",\"name\");\r\n        if(!url) return false;\r\n        if ( !checkNum( [width, height] ) ) return false;\r\n        editor.execCommand('insertvideo', {\r\n            url: convert_url(url),\r\n            width: width.value,\r\n            height: height.value,\r\n            align: align\r\n        }, isModifyUploadVideo ? 'upload':null);\r\n    }\r\n\r\n    /**\r\n     * 将元素id下的所有代表视频的图片插入编辑器中\r\n     * @param id\r\n     */\r\n    function insertSearch(id){\r\n        var imgs = domUtils.getElementsByTagName($G(id),\"img\"),\r\n            videoObjs=[];\r\n        for(var i=0,img; img=imgs[i++];){\r\n            if(img.getAttribute(\"selected\")){\r\n                videoObjs.push({\r\n                    url:img.getAttribute(\"ue_video_url\"),\r\n                    width:420,\r\n                    height:280,\r\n                    align:\"none\"\r\n                });\r\n            }\r\n        }\r\n        editor.execCommand('insertvideo',videoObjs);\r\n    }\r\n\r\n    /**\r\n     * 找到id下具有focus类的节点并返回该节点下的某个属性\r\n     * @param id\r\n     * @param returnProperty\r\n     */\r\n    function findFocus( id, returnProperty ) {\r\n        var tabs = $G( id ).children,\r\n                property;\r\n        for ( var i = 0, ci; ci = tabs[i++]; ) {\r\n            if ( ci.className==\"focus\" ) {\r\n                property = ci.getAttribute( returnProperty );\r\n                break;\r\n            }\r\n        }\r\n        return property;\r\n    }\r\n    function convert_url(url){\r\n        if ( !url ) return '';\r\n        url = utils.trim(url)\r\n            .replace(/v\\.youku\\.com\\/v_show\\/id_([\\w\\-=]+)\\.html/i, 'player.youku.com/player.php/sid/$1/v.swf')\r\n            .replace(/(www\\.)?youtube\\.com\\/watch\\?v=([\\w\\-]+)/i, \"www.youtube.com/v/$2\")\r\n            .replace(/youtu.be\\/(\\w+)$/i, \"www.youtube.com/v/$1\")\r\n            .replace(/v\\.ku6\\.com\\/.+\\/([\\w\\.]+)\\.html.*$/i, \"player.ku6.com/refer/$1/v.swf\")\r\n            .replace(/www\\.56\\.com\\/u\\d+\\/v_([\\w\\-]+)\\.html/i, \"player.56.com/v_$1.swf\")\r\n            .replace(/www.56.com\\/w\\d+\\/play_album\\-aid\\-\\d+_vid\\-([^.]+)\\.html/i, \"player.56.com/v_$1.swf\")\r\n            .replace(/v\\.pps\\.tv\\/play_([\\w]+)\\.html.*$/i, \"player.pps.tv/player/sid/$1/v.swf\")\r\n            .replace(/www\\.letv\\.com\\/ptv\\/vplay\\/([\\d]+)\\.html.*$/i, \"i7.imgs.letv.com/player/swfPlayer.swf?id=$1&autoplay=0\")\r\n            .replace(/www\\.tudou\\.com\\/programs\\/view\\/([\\w\\-]+)\\/?/i, \"www.tudou.com/v/$1\")\r\n            .replace(/v\\.qq\\.com\\/cover\\/[\\w]+\\/[\\w]+\\/([\\w]+)\\.html/i, \"static.video.qq.com/TPout.swf?vid=$1\")\r\n            .replace(/v\\.qq\\.com\\/.+[\\?\\&]vid=([^&]+).*$/i, \"static.video.qq.com/TPout.swf?vid=$1\")\r\n            .replace(/my\\.tv\\.sohu\\.com\\/[\\w]+\\/[\\d]+\\/([\\d]+)\\.shtml.*$/i, \"share.vrs.sohu.com/my/v.swf&id=$1\");\r\n\r\n        return url;\r\n    }\r\n\r\n    /**\r\n      * 检测传入的所有input框中输入的长宽是否是正数\r\n      * @param nodes input框集合，\r\n      */\r\n     function checkNum( nodes ) {\r\n         for ( var i = 0, ci; ci = nodes[i++]; ) {\r\n             var value = ci.value;\r\n             if ( !isNumber( value ) && value) {\r\n                 alert( lang.numError );\r\n                 ci.value = \"\";\r\n                 ci.focus();\r\n                 return false;\r\n             }\r\n         }\r\n         return true;\r\n     }\r\n\r\n    /**\r\n     * 数字判断\r\n     * @param value\r\n     */\r\n    function isNumber( value ) {\r\n        return /(0|^[1-9]\\d*$)/.test( value );\r\n    }\r\n\r\n    /**\r\n      * 创建图片浮动选择按钮\r\n      * @param ids\r\n      */\r\n     function createAlignButton( ids ) {\r\n         for ( var i = 0, ci; ci = ids[i++]; ) {\r\n             var floatContainer = $G( ci ),\r\n                     nameMaps = {\"none\":lang['default'], \"left\":lang.floatLeft, \"right\":lang.floatRight, \"center\":lang.block};\r\n             for ( var j in nameMaps ) {\r\n                 var div = document.createElement( \"div\" );\r\n                 div.setAttribute( \"name\", j );\r\n                 if ( j == \"none\" ) div.className=\"focus\";\r\n                 div.style.cssText = \"background:url(images/\" + j + \"_focus.jpg);\";\r\n                 div.setAttribute( \"title\", nameMaps[j] );\r\n                 floatContainer.appendChild( div );\r\n             }\r\n             switchSelect( ci );\r\n         }\r\n     }\r\n\r\n    /**\r\n     * 选择切换\r\n     * @param selectParentId\r\n     */\r\n    function switchSelect( selectParentId ) {\r\n        var selects = $G( selectParentId ).children;\r\n        for ( var i = 0, ci; ci = selects[i++]; ) {\r\n            domUtils.on( ci, \"click\", function () {\r\n                for ( var j = 0, cj; cj = selects[j++]; ) {\r\n                    cj.className = \"\";\r\n                    cj.removeAttribute && cj.removeAttribute( \"class\" );\r\n                }\r\n                this.className = \"focus\";\r\n            } )\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 监听url改变事件\r\n     * @param url\r\n     */\r\n    function addUrlChangeListener(url){\r\n        if (browser.ie) {\r\n            url.onpropertychange = function () {\r\n                createPreviewVideo( this.value );\r\n            }\r\n        } else {\r\n            url.addEventListener( \"input\", function () {\r\n                createPreviewVideo( this.value );\r\n            }, false );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据url生成视频预览\r\n     * @param url\r\n     */\r\n    function createPreviewVideo(url){\r\n        if ( !url )return;\r\n\r\n        var conUrl = convert_url(url);\r\n\r\n        conUrl = utils.unhtmlForUrl(conUrl);\r\n\r\n        $G(\"preview\").innerHTML = '<div class=\"previewMsg\"><span>'+lang.urlError+'</span></div>'+\r\n        '<embed class=\"previewVideo\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\"' +\r\n            ' src=\"' + conUrl + '\"' +\r\n            ' width=\"' + 420  + '\"' +\r\n            ' height=\"' + 280  + '\"' +\r\n            ' wmode=\"transparent\" play=\"true\" loop=\"false\" menu=\"false\" allowscriptaccess=\"never\" allowfullscreen=\"true\" >' +\r\n        '</embed>';\r\n    }\r\n\r\n\r\n    /* 插入上传视频 */\r\n    function insertUpload(){\r\n        var videoObjs=[],\r\n            uploadDir = editor.getOpt('videoUrlPrefix'),\r\n            width = parseInt($G('upload_width').value, 10) || 420,\r\n            height = parseInt($G('upload_height').value, 10) || 280,\r\n            align = findFocus(\"upload_alignment\",\"name\") || 'none';\r\n        for(var key in uploadVideoList) {\r\n            var file = uploadVideoList[key];\r\n            videoObjs.push({\r\n                url: uploadDir + file.url,\r\n                width:width,\r\n                height:height,\r\n                align:align\r\n            });\r\n        }\r\n\r\n        var count = uploadFile.getQueueCount();\r\n        if (count) {\r\n            $('.info', '#queueList').html('<span style=\"color:red;\">' + '还有2个未上传文件'.replace(/[\\d]/, count) + '</span>');\r\n            return false;\r\n        } else {\r\n            editor.execCommand('insertvideo', videoObjs, 'upload');\r\n        }\r\n    }\r\n\r\n    /*初始化上传标签*/\r\n    function initUpload(){\r\n        uploadFile = new UploadFile('queueList');\r\n    }\r\n\r\n\r\n    /* 上传附件 */\r\n    function UploadFile(target) {\r\n        this.$wrap = target.constructor == String ? $('#' + target) : $(target);\r\n        this.init();\r\n    }\r\n    UploadFile.prototype = {\r\n        init: function () {\r\n            this.fileList = [];\r\n            this.initContainer();\r\n            this.initUploader();\r\n        },\r\n        initContainer: function () {\r\n            this.$queue = this.$wrap.find('.filelist');\r\n        },\r\n        /* 初始化容器 */\r\n        initUploader: function () {\r\n            var _this = this,\r\n                $ = jQuery,    // just in case. Make sure it's not an other libaray.\r\n                $wrap = _this.$wrap,\r\n            // 图片容器\r\n                $queue = $wrap.find('.filelist'),\r\n            // 状态栏，包括进度和控制按钮\r\n                $statusBar = $wrap.find('.statusBar'),\r\n            // 文件总体选择信息。\r\n                $info = $statusBar.find('.info'),\r\n            // 上传按钮\r\n                $upload = $wrap.find('.uploadBtn'),\r\n            // 上传按钮\r\n                $filePickerBtn = $wrap.find('.filePickerBtn'),\r\n            // 上传按钮\r\n                $filePickerBlock = $wrap.find('.filePickerBlock'),\r\n            // 没选择文件之前的内容。\r\n                $placeHolder = $wrap.find('.placeholder'),\r\n            // 总体进度条\r\n                $progress = $statusBar.find('.progress').hide(),\r\n            // 添加的文件数量\r\n                fileCount = 0,\r\n            // 添加的文件总大小\r\n                fileSize = 0,\r\n            // 优化retina, 在retina下这个值是2\r\n                ratio = window.devicePixelRatio || 1,\r\n            // 缩略图大小\r\n                thumbnailWidth = 113 * ratio,\r\n                thumbnailHeight = 113 * ratio,\r\n            // 可能有pedding, ready, uploading, confirm, done.\r\n                state = '',\r\n            // 所有文件的进度信息，key为file id\r\n                percentages = {},\r\n                supportTransition = (function () {\r\n                    var s = document.createElement('p').style,\r\n                        r = 'transition' in s ||\r\n                            'WebkitTransition' in s ||\r\n                            'MozTransition' in s ||\r\n                            'msTransition' in s ||\r\n                            'OTransition' in s;\r\n                    s = null;\r\n                    return r;\r\n                })(),\r\n            // WebUploader实例\r\n                uploader,\r\n                actionUrl = editor.getActionUrl(editor.getOpt('videoActionName')),\r\n                fileMaxSize = editor.getOpt('videoMaxSize'),\r\n                acceptExtensions = (editor.getOpt('videoAllowFiles') || []).join('').replace(/\\./g, ',').replace(/^[,]/, '');;\r\n\r\n            if (!WebUploader.Uploader.support()) {\r\n                $('#filePickerReady').after($('<div>').html(lang.errorNotSupport)).hide();\r\n                return;\r\n            } else if (!editor.getOpt('videoActionName')) {\r\n                $('#filePickerReady').after($('<div>').html(lang.errorLoadConfig)).hide();\r\n                return;\r\n            }\r\n\r\n            uploader = _this.uploader = WebUploader.create({\r\n                pick: {\r\n                    id: '#filePickerReady',\r\n                    label: lang.uploadSelectFile\r\n                },\r\n                swf: '../../third-party/webuploader/Uploader.swf',\r\n                server: actionUrl,\r\n                fileVal: editor.getOpt('videoFieldName'),\r\n                duplicate: true,\r\n                fileSingleSizeLimit: fileMaxSize,\r\n                compress: false\r\n            });\r\n            uploader.addButton({\r\n                id: '#filePickerBlock'\r\n            });\r\n            uploader.addButton({\r\n                id: '#filePickerBtn',\r\n                label: lang.uploadAddFile\r\n            });\r\n\r\n            setState('pedding');\r\n\r\n            // 当有文件添加进来时执行，负责view的创建\r\n            function addFile(file) {\r\n                var $li = $('<li id=\"' + file.id + '\">' +\r\n                        '<p class=\"title\">' + file.name + '</p>' +\r\n                        '<p class=\"imgWrap\"></p>' +\r\n                        '<p class=\"progress\"><span></span></p>' +\r\n                        '</li>'),\r\n\r\n                    $btns = $('<div class=\"file-panel\">' +\r\n                        '<span class=\"cancel\">' + lang.uploadDelete + '</span>' +\r\n                        '<span class=\"rotateRight\">' + lang.uploadTurnRight + '</span>' +\r\n                        '<span class=\"rotateLeft\">' + lang.uploadTurnLeft + '</span></div>').appendTo($li),\r\n                    $prgress = $li.find('p.progress span'),\r\n                    $wrap = $li.find('p.imgWrap'),\r\n                    $info = $('<p class=\"error\"></p>').hide().appendTo($li),\r\n\r\n                    showError = function (code) {\r\n                        switch (code) {\r\n                            case 'exceed_size':\r\n                                text = lang.errorExceedSize;\r\n                                break;\r\n                            case 'interrupt':\r\n                                text = lang.errorInterrupt;\r\n                                break;\r\n                            case 'http':\r\n                                text = lang.errorHttp;\r\n                                break;\r\n                            case 'not_allow_type':\r\n                                text = lang.errorFileType;\r\n                                break;\r\n                            default:\r\n                                text = lang.errorUploadRetry;\r\n                                break;\r\n                        }\r\n                        $info.text(text).show();\r\n                    };\r\n\r\n                if (file.getStatus() === 'invalid') {\r\n                    showError(file.statusText);\r\n                } else {\r\n                    $wrap.text(lang.uploadPreview);\r\n                    if ('|png|jpg|jpeg|bmp|gif|'.indexOf('|'+file.ext.toLowerCase()+'|') == -1) {\r\n                        $wrap.empty().addClass('notimage').append('<i class=\"file-preview file-type-' + file.ext.toLowerCase() + '\"></i>' +\r\n                            '<span class=\"file-title\">' + file.name + '</span>');\r\n                    } else {\r\n                        if (browser.ie && browser.version <= 7) {\r\n                            $wrap.text(lang.uploadNoPreview);\r\n                        } else {\r\n                            uploader.makeThumb(file, function (error, src) {\r\n                                if (error || !src || (/^data:/.test(src) && browser.ie && browser.version <= 7)) {\r\n                                    $wrap.text(lang.uploadNoPreview);\r\n                                } else {\r\n                                    var $img = $('<img src=\"' + src + '\">');\r\n                                    $wrap.empty().append($img);\r\n                                    $img.on('error', function () {\r\n                                        $wrap.text(lang.uploadNoPreview);\r\n                                    });\r\n                                }\r\n                            }, thumbnailWidth, thumbnailHeight);\r\n                        }\r\n                    }\r\n                    percentages[ file.id ] = [ file.size, 0 ];\r\n                    file.rotation = 0;\r\n\r\n                    /* 检查文件格式 */\r\n                    if (!file.ext || acceptExtensions.indexOf(file.ext.toLowerCase()) == -1) {\r\n                        showError('not_allow_type');\r\n                        uploader.removeFile(file);\r\n                    }\r\n                }\r\n\r\n                file.on('statuschange', function (cur, prev) {\r\n                    if (prev === 'progress') {\r\n                        $prgress.hide().width(0);\r\n                    } else if (prev === 'queued') {\r\n                        $li.off('mouseenter mouseleave');\r\n                        $btns.remove();\r\n                    }\r\n                    // 成功\r\n                    if (cur === 'error' || cur === 'invalid') {\r\n                        showError(file.statusText);\r\n                        percentages[ file.id ][ 1 ] = 1;\r\n                    } else if (cur === 'interrupt') {\r\n                        showError('interrupt');\r\n                    } else if (cur === 'queued') {\r\n                        percentages[ file.id ][ 1 ] = 0;\r\n                    } else if (cur === 'progress') {\r\n                        $info.hide();\r\n                        $prgress.css('display', 'block');\r\n                    } else if (cur === 'complete') {\r\n                    }\r\n\r\n                    $li.removeClass('state-' + prev).addClass('state-' + cur);\r\n                });\r\n\r\n                $li.on('mouseenter', function () {\r\n                    $btns.stop().animate({height: 30});\r\n                });\r\n                $li.on('mouseleave', function () {\r\n                    $btns.stop().animate({height: 0});\r\n                });\r\n\r\n                $btns.on('click', 'span', function () {\r\n                    var index = $(this).index(),\r\n                        deg;\r\n\r\n                    switch (index) {\r\n                        case 0:\r\n                            uploader.removeFile(file);\r\n                            return;\r\n                        case 1:\r\n                            file.rotation += 90;\r\n                            break;\r\n                        case 2:\r\n                            file.rotation -= 90;\r\n                            break;\r\n                    }\r\n\r\n                    if (supportTransition) {\r\n                        deg = 'rotate(' + file.rotation + 'deg)';\r\n                        $wrap.css({\r\n                            '-webkit-transform': deg,\r\n                            '-mos-transform': deg,\r\n                            '-o-transform': deg,\r\n                            'transform': deg\r\n                        });\r\n                    } else {\r\n                        $wrap.css('filter', 'progid:DXImageTransform.Microsoft.BasicImage(rotation=' + (~~((file.rotation / 90) % 4 + 4) % 4) + ')');\r\n                    }\r\n\r\n                });\r\n\r\n                $li.insertBefore($filePickerBlock);\r\n            }\r\n\r\n            // 负责view的销毁\r\n            function removeFile(file) {\r\n                var $li = $('#' + file.id);\r\n                delete percentages[ file.id ];\r\n                updateTotalProgress();\r\n                $li.off().find('.file-panel').off().end().remove();\r\n            }\r\n\r\n            function updateTotalProgress() {\r\n                var loaded = 0,\r\n                    total = 0,\r\n                    spans = $progress.children(),\r\n                    percent;\r\n\r\n                $.each(percentages, function (k, v) {\r\n                    total += v[ 0 ];\r\n                    loaded += v[ 0 ] * v[ 1 ];\r\n                });\r\n\r\n                percent = total ? loaded / total : 0;\r\n\r\n                spans.eq(0).text(Math.round(percent * 100) + '%');\r\n                spans.eq(1).css('width', Math.round(percent * 100) + '%');\r\n                updateStatus();\r\n            }\r\n\r\n            function setState(val, files) {\r\n\r\n                if (val != state) {\r\n\r\n                    var stats = uploader.getStats();\r\n\r\n                    $upload.removeClass('state-' + state);\r\n                    $upload.addClass('state-' + val);\r\n\r\n                    switch (val) {\r\n\r\n                        /* 未选择文件 */\r\n                        case 'pedding':\r\n                            $queue.addClass('element-invisible');\r\n                            $statusBar.addClass('element-invisible');\r\n                            $placeHolder.removeClass('element-invisible');\r\n                            $progress.hide(); $info.hide();\r\n                            uploader.refresh();\r\n                            break;\r\n\r\n                        /* 可以开始上传 */\r\n                        case 'ready':\r\n                            $placeHolder.addClass('element-invisible');\r\n                            $queue.removeClass('element-invisible');\r\n                            $statusBar.removeClass('element-invisible');\r\n                            $progress.hide(); $info.show();\r\n                            $upload.text(lang.uploadStart);\r\n                            uploader.refresh();\r\n                            break;\r\n\r\n                        /* 上传中 */\r\n                        case 'uploading':\r\n                            $progress.show(); $info.hide();\r\n                            $upload.text(lang.uploadPause);\r\n                            break;\r\n\r\n                        /* 暂停上传 */\r\n                        case 'paused':\r\n                            $progress.show(); $info.hide();\r\n                            $upload.text(lang.uploadContinue);\r\n                            break;\r\n\r\n                        case 'confirm':\r\n                            $progress.show(); $info.hide();\r\n                            $upload.text(lang.uploadStart);\r\n\r\n                            stats = uploader.getStats();\r\n                            if (stats.successNum && !stats.uploadFailNum) {\r\n                                setState('finish');\r\n                                return;\r\n                            }\r\n                            break;\r\n\r\n                        case 'finish':\r\n                            $progress.hide(); $info.show();\r\n                            if (stats.uploadFailNum) {\r\n                                $upload.text(lang.uploadRetry);\r\n                            } else {\r\n                                $upload.text(lang.uploadStart);\r\n                            }\r\n                            break;\r\n                    }\r\n\r\n                    state = val;\r\n                    updateStatus();\r\n\r\n                }\r\n\r\n                if (!_this.getQueueCount()) {\r\n                    $upload.addClass('disabled')\r\n                } else {\r\n                    $upload.removeClass('disabled')\r\n                }\r\n\r\n            }\r\n\r\n            function updateStatus() {\r\n                var text = '', stats;\r\n\r\n                if (state === 'ready') {\r\n                    text = lang.updateStatusReady.replace('_', fileCount).replace('_KB', WebUploader.formatSize(fileSize));\r\n                } else if (state === 'confirm') {\r\n                    stats = uploader.getStats();\r\n                    if (stats.uploadFailNum) {\r\n                        text = lang.updateStatusConfirm.replace('_', stats.successNum).replace('_', stats.successNum);\r\n                    }\r\n                } else {\r\n                    stats = uploader.getStats();\r\n                    text = lang.updateStatusFinish.replace('_', fileCount).\r\n                        replace('_KB', WebUploader.formatSize(fileSize)).\r\n                        replace('_', stats.successNum);\r\n\r\n                    if (stats.uploadFailNum) {\r\n                        text += lang.updateStatusError.replace('_', stats.uploadFailNum);\r\n                    }\r\n                }\r\n\r\n                $info.html(text);\r\n            }\r\n\r\n            uploader.on('fileQueued', function (file) {\r\n                fileCount++;\r\n                fileSize += file.size;\r\n\r\n                if (fileCount === 1) {\r\n                    $placeHolder.addClass('element-invisible');\r\n                    $statusBar.show();\r\n                }\r\n\r\n                addFile(file);\r\n            });\r\n\r\n            uploader.on('fileDequeued', function (file) {\r\n                fileCount--;\r\n                fileSize -= file.size;\r\n\r\n                removeFile(file);\r\n                updateTotalProgress();\r\n            });\r\n\r\n            uploader.on('filesQueued', function (file) {\r\n                if (!uploader.isInProgress() && (state == 'pedding' || state == 'finish' || state == 'confirm' || state == 'ready')) {\r\n                    setState('ready');\r\n                }\r\n                updateTotalProgress();\r\n            });\r\n\r\n            uploader.on('all', function (type, files) {\r\n                switch (type) {\r\n                    case 'uploadFinished':\r\n                        setState('confirm', files);\r\n                        break;\r\n                    case 'startUpload':\r\n                        /* 添加额外的GET参数 */\r\n                        var params = utils.serializeParam(editor.queryCommandValue('serverparam')) || '',\r\n                            url = utils.formatUrl(actionUrl + (actionUrl.indexOf('?') == -1 ? '?':'&') + 'encode=utf-8&' + params);\r\n                        uploader.option('server', url);\r\n                        setState('uploading', files);\r\n                        break;\r\n                    case 'stopUpload':\r\n                        setState('paused', files);\r\n                        break;\r\n                }\r\n            });\r\n\r\n            uploader.on('uploadBeforeSend', function (file, data, header) {\r\n                //这里可以通过data对象添加POST参数\r\n                header['X_Requested_With'] = 'XMLHttpRequest';\r\n            });\r\n\r\n            uploader.on('uploadProgress', function (file, percentage) {\r\n                var $li = $('#' + file.id),\r\n                    $percent = $li.find('.progress span');\r\n\r\n                $percent.css('width', percentage * 100 + '%');\r\n                percentages[ file.id ][ 1 ] = percentage;\r\n                updateTotalProgress();\r\n            });\r\n\r\n            uploader.on('uploadSuccess', function (file, ret) {\r\n                var $file = $('#' + file.id);\r\n                try {\r\n                    var responseText = (ret._raw || ret),\r\n                        json = utils.str2json(responseText);\r\n                    if (json.state == 'SUCCESS') {\r\n                        uploadVideoList.push({\r\n                            'url': json.url,\r\n                            'type': json.type,\r\n                            'original':json.original\r\n                        });\r\n                        $file.append('<span class=\"success\"></span>');\r\n                    } else {\r\n                        $file.find('.error').text(json.state).show();\r\n                    }\r\n                } catch (e) {\r\n                    $file.find('.error').text(lang.errorServerUpload).show();\r\n                }\r\n            });\r\n\r\n            uploader.on('uploadError', function (file, code) {\r\n            });\r\n            uploader.on('error', function (code, file) {\r\n                if (code == 'Q_TYPE_DENIED' || code == 'F_EXCEED_SIZE') {\r\n                    addFile(file);\r\n                }\r\n            });\r\n            uploader.on('uploadComplete', function (file, ret) {\r\n            });\r\n\r\n            $upload.on('click', function () {\r\n                if ($(this).hasClass('disabled')) {\r\n                    return false;\r\n                }\r\n\r\n                if (state === 'ready') {\r\n                    uploader.upload();\r\n                } else if (state === 'paused') {\r\n                    uploader.upload();\r\n                } else if (state === 'uploading') {\r\n                    uploader.stop();\r\n                }\r\n            });\r\n\r\n            $upload.addClass('state-' + state);\r\n            updateTotalProgress();\r\n        },\r\n        getQueueCount: function () {\r\n            var file, i, status, readyFile = 0, files = this.uploader.getFiles();\r\n            for (i = 0; file = files[i++]; ) {\r\n                status = file.getStatus();\r\n                if (status == 'queued' || status == 'uploading' || status == 'progress') readyFile++;\r\n            }\r\n            return readyFile;\r\n        },\r\n        refresh: function(){\r\n            this.uploader.refresh();\r\n        }\r\n    };\r\n\r\n})();\r\n"]}