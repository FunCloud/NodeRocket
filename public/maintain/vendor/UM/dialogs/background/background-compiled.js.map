{"version":3,"sources":["background.js"],"names":[],"mappings":"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","file":"background-compiled.js","sourcesContent":["(function () {\r\n\r\n    var onlineImage,\r\n        backupStyle = editor.queryCommandValue('background');\r\n\r\n    window.onload = function () {\r\n        initTabs();\r\n        initColorSelector();\r\n    };\r\n\r\n    /* 初始化tab标签 */\r\n    function initTabs(){\r\n        var tabs = $G('tabHeads').children;\r\n        for (var i = 0; i < tabs.length; i++) {\r\n            domUtils.on(tabs[i], \"click\", function (e) {\r\n                var target = e.target || e.srcElement;\r\n                for (var j = 0; j < tabs.length; j++) {\r\n                    if(tabs[j] == target){\r\n                        tabs[j].className = \"focus\";\r\n                        var contentId = tabs[j].getAttribute('data-content-id');\r\n                        $G(contentId).style.display = \"block\";\r\n                        if(contentId == 'imgManager') {\r\n                            initImagePanel();\r\n                        }\r\n                    }else {\r\n                        tabs[j].className = \"\";\r\n                        $G(tabs[j].getAttribute('data-content-id')).style.display = \"none\";\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /* 初始化颜色设置 */\r\n    function initColorSelector () {\r\n        var obj = editor.queryCommandValue('background');\r\n        if (obj) {\r\n            var color = obj['background-color'],\r\n                repeat = obj['background-repeat'] || 'repeat',\r\n                image = obj['background-image'] || '',\r\n                position = obj['background-position'] || 'center center',\r\n                pos = position.split(' '),\r\n                x = parseInt(pos[0]) || 0,\r\n                y = parseInt(pos[1]) || 0;\r\n\r\n            if(repeat == 'no-repeat' && (x || y)) repeat = 'self';\r\n\r\n            image = image.match(/url[\\s]*\\(([^\\)]*)\\)/);\r\n            image = image ? image[1]:'';\r\n            updateFormState('colored', color, image, repeat, x, y);\r\n        } else {\r\n            updateFormState();\r\n        }\r\n\r\n        var updateHandler = function () {\r\n            updateFormState();\r\n            updateBackground();\r\n        }\r\n        domUtils.on($G('nocolorRadio'), 'click', updateBackground);\r\n        domUtils.on($G('coloredRadio'), 'click', updateHandler);\r\n        domUtils.on($G('url'), 'keyup', function(){\r\n            if($G('url').value && $G('alignment').style.display == \"none\") {\r\n                utils.each($G('repeatType').children, function(item){\r\n                    item.selected = ('repeat' == item.getAttribute('value') ? 'selected':false);\r\n                });\r\n            }\r\n            updateHandler();\r\n        });\r\n        domUtils.on($G('repeatType'), 'change', updateHandler);\r\n        domUtils.on($G('x'), 'keyup', updateBackground);\r\n        domUtils.on($G('y'), 'keyup', updateBackground);\r\n\r\n        initColorPicker();\r\n    }\r\n\r\n    /* 初始化颜色选择器 */\r\n    function initColorPicker() {\r\n        var me = editor,\r\n            cp = $G(\"colorPicker\");\r\n\r\n        /* 生成颜色选择器ui对象 */\r\n        var popup = new UE.ui.Popup({\r\n            content: new UE.ui.ColorPicker({\r\n                noColorText: me.getLang(\"clearColor\"),\r\n                editor: me,\r\n                onpickcolor: function (t, color) {\r\n                    updateFormState('colored', color);\r\n                    updateBackground();\r\n                    UE.ui.Popup.postHide();\r\n                },\r\n                onpicknocolor: function (t, color) {\r\n                    updateFormState('colored', 'transparent');\r\n                    updateBackground();\r\n                    UE.ui.Popup.postHide();\r\n                }\r\n            }),\r\n            editor: me,\r\n            onhide: function () {\r\n            }\r\n        });\r\n\r\n        /* 设置颜色选择器 */\r\n        domUtils.on(cp, \"click\", function () {\r\n            popup.showAnchor(this);\r\n        });\r\n        domUtils.on(document, 'mousedown', function (evt) {\r\n            var el = evt.target || evt.srcElement;\r\n            UE.ui.Popup.postHide(el);\r\n        });\r\n        domUtils.on(window, 'scroll', function () {\r\n            UE.ui.Popup.postHide();\r\n        });\r\n    }\r\n\r\n    /* 初始化在线图片列表 */\r\n    function initImagePanel() {\r\n        onlineImage = onlineImage || new OnlineImage('imageList');\r\n    }\r\n\r\n    /* 更新背景色设置面板 */\r\n    function updateFormState (radio, color, url, align, x, y) {\r\n        var nocolorRadio = $G('nocolorRadio'),\r\n            coloredRadio = $G('coloredRadio');\r\n\r\n        if(radio) {\r\n            nocolorRadio.checked = (radio == 'colored' ? false:'checked');\r\n            coloredRadio.checked = (radio == 'colored' ? 'checked':false);\r\n        }\r\n        if(color) {\r\n            domUtils.setStyle($G(\"colorPicker\"), \"background-color\", color);\r\n        }\r\n\r\n        if(url && /^\\//.test(url)) {\r\n            var a = document.createElement('a');\r\n            a.href = url;\r\n            browser.ie && (a.href = a.href);\r\n            url = browser.ie ? a.href:(a.protocol + '//' + a.host + a.pathname + a.search + a.hash);\r\n        }\r\n\r\n        if(url || url === '') {\r\n            $G('url').value = url;\r\n        }\r\n        if(align) {\r\n            utils.each($G('repeatType').children, function(item){\r\n                item.selected = (align == item.getAttribute('value') ? 'selected':false);\r\n            });\r\n        }\r\n        if(x || y) {\r\n            $G('x').value = parseInt(x) || 0;\r\n            $G('y').value = parseInt(y) || 0;\r\n        }\r\n\r\n        $G('alignment').style.display = coloredRadio.checked && $G('url').value ? '':'none';\r\n        $G('custom').style.display = coloredRadio.checked && $G('url').value && $G('repeatType').value == 'self' ? '':'none';\r\n    }\r\n\r\n    /* 更新背景颜色 */\r\n    function updateBackground () {\r\n        if ($G('coloredRadio').checked) {\r\n            var color = domUtils.getStyle($G(\"colorPicker\"), \"background-color\"),\r\n                bgimg = $G(\"url\").value,\r\n                align = $G(\"repeatType\").value,\r\n                backgroundObj = {\r\n                    \"background-repeat\": \"no-repeat\",\r\n                    \"background-position\": \"center center\"\r\n                };\r\n\r\n            if (color) backgroundObj[\"background-color\"] = color;\r\n            if (bgimg) backgroundObj[\"background-image\"] = 'url(' + bgimg + ')';\r\n            if (align == 'self') {\r\n                backgroundObj[\"background-position\"] = $G(\"x\").value + \"px \" + $G(\"y\").value + \"px\";\r\n            } else if (align == 'repeat-x' || align == 'repeat-y' || align == 'repeat') {\r\n                backgroundObj[\"background-repeat\"] = align;\r\n            }\r\n\r\n            editor.execCommand('background', backgroundObj);\r\n        } else {\r\n            editor.execCommand('background', null);\r\n        }\r\n    }\r\n\r\n\r\n    /* 在线图片 */\r\n    function OnlineImage(target) {\r\n        this.container = utils.isString(target) ? document.getElementById(target) : target;\r\n        this.init();\r\n    }\r\n    OnlineImage.prototype = {\r\n        init: function () {\r\n            this.reset();\r\n            this.initEvents();\r\n        },\r\n        /* 初始化容器 */\r\n        initContainer: function () {\r\n            this.container.innerHTML = '';\r\n            this.list = document.createElement('ul');\r\n            this.clearFloat = document.createElement('li');\r\n\r\n            domUtils.addClass(this.list, 'list');\r\n            domUtils.addClass(this.clearFloat, 'clearFloat');\r\n\r\n            this.list.id = 'imageListUl';\r\n            this.list.appendChild(this.clearFloat);\r\n            this.container.appendChild(this.list);\r\n        },\r\n        /* 初始化滚动事件,滚动到地步自动拉取数据 */\r\n        initEvents: function () {\r\n            var _this = this;\r\n\r\n            /* 滚动拉取图片 */\r\n            domUtils.on($G('imageList'), 'scroll', function(e){\r\n                var panel = this;\r\n                if (panel.scrollHeight - (panel.offsetHeight + panel.scrollTop) < 10) {\r\n                    _this.getImageData();\r\n                }\r\n            });\r\n            /* 选中图片 */\r\n            domUtils.on(this.container, 'click', function (e) {\r\n                var target = e.target || e.srcElement,\r\n                    li = target.parentNode,\r\n                    nodes = $G('imageListUl').childNodes;\r\n\r\n                if (li.tagName.toLowerCase() == 'li') {\r\n                    updateFormState('nocolor', null, '');\r\n                    for (var i = 0, node; node = nodes[i++];) {\r\n                        if (node == li && !domUtils.hasClass(node, 'selected')) {\r\n                            domUtils.addClass(node, 'selected');\r\n                            updateFormState('colored', null, li.firstChild.getAttribute(\"_src\"), 'repeat');\r\n                        } else {\r\n                            domUtils.removeClasses(node, 'selected');\r\n                        }\r\n                    }\r\n                    updateBackground();\r\n                }\r\n            });\r\n        },\r\n        /* 初始化第一次的数据 */\r\n        initData: function () {\r\n\r\n            /* 拉取数据需要使用的值 */\r\n            this.state = 0;\r\n            this.listSize = editor.getOpt('imageManagerListSize');\r\n            this.listIndex = 0;\r\n            this.listEnd = false;\r\n\r\n            /* 第一次拉取数据 */\r\n            this.getImageData();\r\n        },\r\n        /* 重置界面 */\r\n        reset: function() {\r\n            this.initContainer();\r\n            this.initData();\r\n        },\r\n        /* 向后台拉取图片列表数据 */\r\n        getImageData: function () {\r\n            var _this = this;\r\n\r\n            if(!_this.listEnd && !this.isLoadingData) {\r\n                this.isLoadingData = true;\r\n                var url = editor.getActionUrl(editor.getOpt('imageManagerActionName')),\r\n                    isJsonp = utils.isCrossDomainUrl(url);\r\n                ajax.request(url, {\r\n                    'timeout': 100000,\r\n                    'dataType': isJsonp ? 'jsonp':'',\r\n                    'data': utils.extend({\r\n                            start: this.listIndex,\r\n                            size: this.listSize\r\n                        }, editor.queryCommandValue('serverparam')),\r\n                    'method': 'get',\r\n                    'onsuccess': function (r) {\r\n                        try {\r\n                            var json = isJsonp ? r:eval('(' + r.responseText + ')');\r\n                            if (json.state == 'SUCCESS') {\r\n                                _this.pushData(json.list);\r\n                                _this.listIndex = parseInt(json.start) + parseInt(json.list.length);\r\n                                if(_this.listIndex >= json.total) {\r\n                                    _this.listEnd = true;\r\n                                }\r\n                                _this.isLoadingData = false;\r\n                            }\r\n                        } catch (e) {\r\n                            if(r.responseText.indexOf('ue_separate_ue') != -1) {\r\n                                var list = r.responseText.split(r.responseText);\r\n                                _this.pushData(list);\r\n                                _this.listIndex = parseInt(list.length);\r\n                                _this.listEnd = true;\r\n                                _this.isLoadingData = false;\r\n                            }\r\n                        }\r\n                    },\r\n                    'onerror': function () {\r\n                        _this.isLoadingData = false;\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        /* 添加图片到列表界面上 */\r\n        pushData: function (list) {\r\n            var i, item, img, icon, _this = this,\r\n                urlPrefix = editor.getOpt('imageManagerUrlPrefix');\r\n            for (i = 0; i < list.length; i++) {\r\n                if(list[i] && list[i].url) {\r\n                    item = document.createElement('li');\r\n                    img = document.createElement('img');\r\n                    icon = document.createElement('span');\r\n\r\n                    domUtils.on(img, 'load', (function(image){\r\n                        return function(){\r\n                            _this.scale(image, image.parentNode.offsetWidth, image.parentNode.offsetHeight);\r\n                        }\r\n                    })(img));\r\n                    img.width = 113;\r\n                    img.setAttribute('src', urlPrefix + list[i].url + (list[i].url.indexOf('?') == -1 ? '?noCache=':'&noCache=') + (+new Date()).toString(36) );\r\n                    img.setAttribute('_src', urlPrefix + list[i].url);\r\n                    domUtils.addClass(icon, 'icon');\r\n\r\n                    item.appendChild(img);\r\n                    item.appendChild(icon);\r\n                    this.list.insertBefore(item, this.clearFloat);\r\n                }\r\n            }\r\n        },\r\n        /* 改变图片大小 */\r\n        scale: function (img, w, h, type) {\r\n            var ow = img.width,\r\n                oh = img.height;\r\n\r\n            if (type == 'justify') {\r\n                if (ow >= oh) {\r\n                    img.width = w;\r\n                    img.height = h * oh / ow;\r\n                    img.style.marginLeft = '-' + parseInt((img.width - w) / 2) + 'px';\r\n                } else {\r\n                    img.width = w * ow / oh;\r\n                    img.height = h;\r\n                    img.style.marginTop = '-' + parseInt((img.height - h) / 2) + 'px';\r\n                }\r\n            } else {\r\n                if (ow >= oh) {\r\n                    img.width = w * ow / oh;\r\n                    img.height = h;\r\n                    img.style.marginLeft = '-' + parseInt((img.width - w) / 2) + 'px';\r\n                } else {\r\n                    img.width = w;\r\n                    img.height = h * oh / ow;\r\n                    img.style.marginTop = '-' + parseInt((img.height - h) / 2) + 'px';\r\n                }\r\n            }\r\n        },\r\n        getInsertList: function () {\r\n            var i, lis = this.list.children, list = [], align = getAlign();\r\n            for (i = 0; i < lis.length; i++) {\r\n                if (domUtils.hasClass(lis[i], 'selected')) {\r\n                    var img = lis[i].firstChild,\r\n                        src = img.getAttribute('_src');\r\n                    list.push({\r\n                        src: src,\r\n                        _src: src,\r\n                        floatStyle: align\r\n                    });\r\n                }\r\n\r\n            }\r\n            return list;\r\n        }\r\n    };\r\n\r\n    dialog.onok = function () {\r\n        updateBackground();\r\n        editor.fireEvent('saveScene');\r\n    };\r\n    dialog.oncancel = function () {\r\n        editor.execCommand('background', backupStyle);\r\n    };\r\n\r\n})();"]}