{"version":3,"sources":["bootstrap-wysiwyg.js"],"names":[],"mappings":"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","file":"bootstrap-wysiwyg-compiled.js","sourcesContent":["/* http://github.com/mindmup/bootstrap-wysiwyg */\r\n/*global jQuery, $, FileReader*/\r\n/*jslint browser:true*/\r\n(function ($) {\r\n\t'use strict';\r\n\tvar readFileIntoDataUrl = function (fileInfo) {\r\n\t\tvar loader = $.Deferred(),\r\n\t\t\tfReader = new FileReader();\r\n\t\tfReader.onload = function (e) {\r\n\t\t\tloader.resolve(e.target.result);\r\n\t\t};\r\n\t\tfReader.onerror = loader.reject;\r\n\t\tfReader.onprogress = loader.notify;\r\n\t\tfReader.readAsDataURL(fileInfo);\r\n\t\treturn loader.promise();\r\n\t};\r\n\t$.fn.cleanHtml = function () {\r\n\t\tvar html = $(this).html();\r\n\t\treturn html && html.replace(/(<br>|\\s|<div><br><\\/div>|&nbsp;)*$/, '');\r\n\t};\r\n\t$.fn.wysiwyg = function (userOptions) {\r\n\t\tvar editor = this,\r\n\t\t\tselectedRange,\r\n\t\t\toptions,\r\n\t\t\ttoolbarBtnSelector,\r\n\t\t\tupdateToolbar = function () {\r\n\t\t\t\tif (options.activeToolbarClass) {\r\n\t\t\t\t\t$(options.toolbarSelector).find(toolbarBtnSelector).each(function () {\r\n\t\t\t\t\t\tvar command = $(this).data(options.commandRole);\r\n\t\t\t\t\t\tif (document.queryCommandState(command)) {\r\n\t\t\t\t\t\t\t$(this).addClass(options.activeToolbarClass);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(this).removeClass(options.activeToolbarClass);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\texecCommand = function (commandWithArgs, valueArg) {\r\n\t\t\t\tvar commandArr = commandWithArgs.split(' '),\r\n\t\t\t\t\tcommand = commandArr.shift(),\r\n\t\t\t\t\targs = commandArr.join(' ') + (valueArg || '');\r\n\t\t\t\tdocument.execCommand(command, 0, args);\r\n\t\t\t\tupdateToolbar();\r\n\t\t\t},\r\n\t\t\tbindHotkeys = function (hotKeys) {\r\n\t\t\t\t$.each(hotKeys, function (hotkey, command) {\r\n\t\t\t\t\teditor.keydown(hotkey, function (e) {\r\n\t\t\t\t\t\tif (editor.attr('contenteditable') && editor.is(':visible')) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\texecCommand(command);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).keyup(hotkey, function (e) {\r\n\t\t\t\t\t\tif (editor.attr('contenteditable') && editor.is(':visible')) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetCurrentRange = function () {\r\n\t\t\t\tvar sel = window.getSelection();\r\n\t\t\t\tif (sel.getRangeAt && sel.rangeCount) {\r\n\t\t\t\t\treturn sel.getRangeAt(0);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsaveSelection = function () {\r\n\t\t\t\tselectedRange = getCurrentRange();\r\n\t\t\t},\r\n\t\t\trestoreSelection = function () {\r\n\t\t\t\tvar selection = window.getSelection();\r\n\t\t\t\tif (selectedRange) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tselection.removeAllRanges();\r\n\t\t\t\t\t} catch (ex) {\r\n\t\t\t\t\t\tdocument.body.createTextRange().select();\r\n\t\t\t\t\t\tdocument.selection.empty();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tselection.addRange(selectedRange);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tinsertFiles = function (files) {\r\n\t\t\t\teditor.focus();\r\n\t\t\t\t$.each(files, function (idx, fileInfo) {\r\n\t\t\t\t\tif (/^image\\//.test(fileInfo.type)) {\r\n\t\t\t\t\t\t$.when(readFileIntoDataUrl(fileInfo)).done(function (dataUrl) {\r\n\t\t\t\t\t\t\texecCommand('insertimage', dataUrl);\r\n\t\t\t\t\t\t}).fail(function (e) {\r\n\t\t\t\t\t\t\toptions.fileUploadError(\"file-reader\", e);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toptions.fileUploadError(\"unsupported-file-type\", fileInfo.type);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tmarkSelection = function (input, color) {\r\n\t\t\t\trestoreSelection();\r\n\t\t\t\tif (document.queryCommandSupported('hiliteColor')) {\r\n\t\t\t\t\tdocument.execCommand('hiliteColor', 0, color || 'transparent');\r\n\t\t\t\t}\r\n\t\t\t\tsaveSelection();\r\n\t\t\t\tinput.data(options.selectionMarker, color);\r\n\t\t\t},\r\n\t\t\tbindToolbar = function (toolbar, options) {\r\n\t\t\t\ttoolbar.find(toolbarBtnSelector).click(function () {\r\n\t\t\t\t\trestoreSelection();\r\n\t\t\t\t\teditor.focus();\r\n\t\t\t\t\texecCommand($(this).data(options.commandRole));\r\n\t\t\t\t\tsaveSelection();\r\n\t\t\t\t});\r\n\t\t\t\ttoolbar.find('[data-toggle=dropdown]').click(restoreSelection);\r\n\r\n\t\t\t\ttoolbar.find('input[type=text][data-' + options.commandRole + ']').on('webkitspeechchange change', function () {\r\n\t\t\t\t\tvar newValue = this.value; /* ugly but prevents fake double-calls due to selection restoration */\r\n\t\t\t\t\tthis.value = '';\r\n\t\t\t\t\trestoreSelection();\r\n\t\t\t\t\tif (newValue) {\r\n\t\t\t\t\t\teditor.focus();\r\n\t\t\t\t\t\texecCommand($(this).data(options.commandRole), newValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsaveSelection();\r\n\t\t\t\t}).on('focus', function () {\r\n\t\t\t\t\tvar input = $(this);\r\n\t\t\t\t\tif (!input.data(options.selectionMarker)) {\r\n\t\t\t\t\t\tmarkSelection(input, options.selectionColor);\r\n\t\t\t\t\t\tinput.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}).on('blur', function () {\r\n\t\t\t\t\tvar input = $(this);\r\n\t\t\t\t\tif (input.data(options.selectionMarker)) {\r\n\t\t\t\t\t\tmarkSelection(input, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\ttoolbar.find('input[type=file][data-' + options.commandRole + ']').change(function () {\r\n\t\t\t\t\trestoreSelection();\r\n\t\t\t\t\tif (this.type === 'file' && this.files && this.files.length > 0) {\r\n\t\t\t\t\t\tinsertFiles(this.files);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsaveSelection();\r\n\t\t\t\t\tthis.value = '';\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tinitFileDrops = function () {\r\n\t\t\t\teditor.on('dragenter dragover', false)\r\n\t\t\t\t\t.on('drop', function (e) {\r\n\t\t\t\t\t\tvar dataTransfer = e.originalEvent.dataTransfer;\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tif (dataTransfer && dataTransfer.files && dataTransfer.files.length > 0) {\r\n\t\t\t\t\t\t\tinsertFiles(dataTransfer.files);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t};\r\n\t\toptions = $.extend({}, $.fn.wysiwyg.defaults, userOptions);\r\n\t\ttoolbarBtnSelector = 'a[data-' + options.commandRole + '],button[data-' + options.commandRole + '],input[type=button][data-' + options.commandRole + ']';\r\n\t\tbindHotkeys(options.hotKeys);\r\n\t\tif (options.dragAndDropImages) {\r\n\t\t\tinitFileDrops();\r\n\t\t}\r\n\t\tbindToolbar($(options.toolbarSelector), options);\r\n\t\teditor.attr('contenteditable', true)\r\n\t\t\t.on('mouseup keyup mouseout', function () {\r\n\t\t\t\tsaveSelection();\r\n\t\t\t\tupdateToolbar();\r\n\t\t\t});\r\n\t\t$(window).bind('touchend', function (e) {\r\n\t\t\tvar isInside = (editor.is(e.target) || editor.has(e.target).length > 0),\r\n\t\t\t\tcurrentRange = getCurrentRange(),\r\n\t\t\t\tclear = currentRange && (currentRange.startContainer === currentRange.endContainer && currentRange.startOffset === currentRange.endOffset);\r\n\t\t\tif (!clear || isInside) {\r\n\t\t\t\tsaveSelection();\r\n\t\t\t\tupdateToolbar();\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn this;\r\n\t};\r\n\t$.fn.wysiwyg.defaults = {\r\n\t\thotKeys: {\r\n\t\t\t'ctrl+b meta+b': 'bold',\r\n\t\t\t'ctrl+i meta+i': 'italic',\r\n\t\t\t'ctrl+u meta+u': 'underline',\r\n\t\t\t'ctrl+z meta+z': 'undo',\r\n\t\t\t'ctrl+y meta+y meta+shift+z': 'redo',\r\n\t\t\t'ctrl+l meta+l': 'justifyleft',\r\n\t\t\t'ctrl+r meta+r': 'justifyright',\r\n\t\t\t'ctrl+e meta+e': 'justifycenter',\r\n\t\t\t'ctrl+j meta+j': 'justifyfull',\r\n\t\t\t'shift+tab': 'outdent',\r\n\t\t\t'tab': 'indent'\r\n\t\t},\r\n\t\ttoolbarSelector: '[data-role=editor-toolbar]',\r\n\t\tcommandRole: 'edit',\r\n\t\tactiveToolbarClass: 'btn-info',\r\n\t\tselectionMarker: 'edit-focus-marker',\r\n\t\tselectionColor: 'darkgrey',\r\n\t\tdragAndDropImages: true,\r\n\t\tfileUploadError: function (reason, detail) { console.log(\"File upload error\", reason, detail); }\r\n\t};\r\n}(window.jQuery));\r\n"]}