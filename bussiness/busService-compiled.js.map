{"version":3,"sources":["busService.js"],"names":[],"mappings":"AAAA,IAAI,MAAM,QAAQ,gBAAR,EAA0B,IAApC;AACA,IAAI,KAAK,QAAQ,IAAR,CAAT;AACA,IAAI,IAAI,QAAQ,QAAR,CAAR;AACA,IAAI,iBAAiB,QAAQ,kBAAR,CAArB;;AAEA,aAAa;;AAEZ,aAAW,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AACjC,MAAI,UAAU,IAAI,UAAJ,CAAe;AAC5B,YAAS,MAAM,OADa;AAE5B,WAAO,MAAM,MAFe;AAG5B,SAAK,MAAM,IAHiB;AAI5B,SAAK,MAAM;AAJiB,GAAf,EAKX,IALW,CAKN,UAAS,IAAT,EAAc;AACrB,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAPa,CAAd;AAQA,EAXW;AAYZ,QAAM,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AAC5B,MAAI,eAAJ,CAAoB,KAApB,EAA2B,IAA3B,CAAgC,UAAS,IAAT,EAAc;AAC7C,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAFD;AAGA,EAhBW;AAiBZ,eAAe,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAwB;AACtC,KACC,aAAY;AACX,OAAI,UAAU,MAAM,IAAI,eAAJ,CAAoB,KAApB,CAApB;AACA,WAAQ,GAAR,CAAY,OAAZ;AACA,OAAI,QAAS,EAAE,GAAF,CAAM,OAAN,EAAc,SAAd,CAAb;AACA,OAAI,UAAU,MAAM,eAAe,UAAf,CAA0B,KAA1B,CAApB;AACA,WAAQ,GAAR,CAAY,OAAZ;AACA,WAAQ,OAAR,CAAgB,KAAG,EAAE,OAAF,GAAa,QAAQ,IAAR,CAAa,KAAG,EAAE,GAAF,IAAO,EAAE,OAAzB,CAAD,GAAqC,QAAQ,IAAR,CAAa,KAAG,EAAE,GAAF,IAAO,EAAE,OAAzB,CAAD,CAAoC,IAAxE,GAA6E,EAA5G;AACA,UAAO,OAAP;AACA,GATF,EAUE,IAVF,CAUO,UAAS,IAAT,EAAc;AACpB,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAZD;AAaA,EA/BW;AAgCZ,iBAAe,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AACrC,MAAI,eAAJ,CAAoB,EAAC,SAAQ,MAAM,OAAf,EAApB,EAA6C,IAA7C,CAAkD,UAAS,IAAT,EAAc;AAC/D,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAFD;AAGA,EApCW;AAqCZ,SAAO,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AAC7B,MAAI,YAAJ,CAAiB,EAAC,KAAI,MAAM,GAAX,EAAjB,EAAkC,IAAlC,CAAuC,UAAS,IAAT,EAAc;AACpD,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAFD;AAGA,EAzCW;AA0CZ,SAAO,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AAC7B,MAAI,YAAJ,CAAiB,EAAC,KAAI,MAAM,GAAX,EAAjB,EAAiC;AAChC,YAAS,MAAM,OADiB;AAEhC,WAAO,MAAM,MAFmB;AAGhC,SAAK,MAAM;AAHqB,GAAjC,EAIG,IAJH,CAIQ,UAAS,IAAT,EAAc;AACrB,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAND;AAOA;AAlDW,CAAb;;AAqDA,OAAO,OAAP,GAAiB,UAAjB","file":"busService-compiled.js","sourcesContent":["var bus = require('../models/buss').buss;\nvar co = require('co');\nvar _ = require('lodash');\nvar busTypeService = require('./busTypeService');\n\nbusService = {\n\t//这里是保存实体\n\tsaveEntity:function(req,res,param){\n\t\tvar result1 = bus.saveEntity({\n\t\t\tbusType: param.busType,\n\t\t\tsortNo:param.sortNo,\n\t\t\tlogo:param.logo,\n\t\t\tname:param.name\n\t\t}).then(function(data){ \n\t\t\tres.send(global.configResult(data));\n\t\t});\n\t},\n\tquery:function(req,res,param){\n\t\tbus.findByCondition(param).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t}); \n\t},\n\tqueryAndType : function(req,res,param) {\n\t\tco(\n\t\t\tfunction*() {\n\t\t\t\tvar result1 = yield bus.findByCondition(param);\n\t\t\t\tconsole.log(result1);\n\t\t\t\tvar types =  _.map(result1,'busType');\n\t\t\t\tvar result2 = yield busTypeService.queryByIds(types);\n\t\t\t\tconsole.log(result2);\n\t\t\t\tresult1.forEach(x=>x.busType = (result2.find(y=>y._id==x.busType))?(result2.find(y=>y._id==x.busType)).name:'');\n\t\t\t\treturn result1;\n\t\t\t}\n\t\t).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t})\n\t},\n\tqueryByBusType:function(req,res,param){\n\t\tbus.findByCondition({busType:param.busType}).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t});\n\t},\n\tdelete:function(req,res,param){\n\t\tbus.deleteEntity({_id:param._id}).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t});\n\t},\n\tupdate:function(req,res,param){\n\t\tbus.updateEntity({_id:param._id},{\n\t\t\tbusType: param.busType,\n\t\t\tsortNo:param.sortNo,\n\t\t\tlogo:param.logo\n\t\t}).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t});\n\t}\n}\n\nmodule.exports = busService;\n"]}