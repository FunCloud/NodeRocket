{"version":3,"sources":["workService.js"],"names":[],"mappings":"AAAA,IAAI,KAAK,QAAQ,IAAR,CAAT;AACA,IAAI,QAAQ,QAAQ,iBAAR,EAA2B,KAAvC;AACA,IAAI,kBAAkB,QAAQ,mBAAR,CAAtB;AACA,IAAI,IAAI,QAAQ,QAAR,CAAR;AACA,eAAe;;AAEd,aAAW,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AACjC,MAAI,UAAU,MAAM,UAAN,CAAiB;AAC9B,aAAU,MAAM,QADc;AAE9B,WAAO,MAAM,MAFiB;AAG9B,aAAS,MAAM,QAHe;AAI9B,UAAM,MAAM,KAJkB;AAK9B,WAAO,MAAM,MALiB;AAM9B,YAAQ,MAAM,OANgB;AAO9B,SAAK,MAAM;AAPmB,GAAjB,EAQX,IARW,CAQN,UAAS,IAAT,EAAc;AACrB,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAVa,CAAd;AAWA,EAda;AAed,QAAM,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AAC5B,QAAM,eAAN,CAAsB,KAAtB,EAA6B,IAA7B,CAAkC,UAAS,IAAT,EAAc;AAC/C,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAFD;AAGA,EAnBa;AAoBd,eAAe,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAwB;AACtC,KACC,aAAY;AACX,OAAI,UAAU,MAAM,MAAM,eAAN,CAAsB,KAAtB,CAApB;AACA,OAAI,QAAS,EAAE,GAAF,CAAM,OAAN,EAAc,UAAd,CAAb;AACA,OAAI,UAAU,MAAM,gBAAgB,UAAhB,CAA2B,KAA3B,CAApB;AACA,WAAQ,OAAR,CAAgB,KAAG,EAAE,QAAF,GAAc,QAAQ,IAAR,CAAa,KAAG,EAAE,GAAF,IAAO,EAAE,QAAzB,CAAD,GAAsC,QAAQ,IAAR,CAAa,KAAG,EAAE,GAAF,IAAO,EAAE,QAAzB,CAAD,CAAqC,IAA1E,GAA+E,EAA/G;AACA,UAAO,OAAP;AACA,GAPF,EAQE,IARF,CAQO,UAAS,IAAT,EAAc;AACpB,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAVD;AAWA,EAhCa;AAiCd,SAAO,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AAC7B,QAAM,YAAN,CAAmB,EAAC,KAAI,MAAM,GAAX,EAAnB,EAAoC,IAApC,CAAyC,UAAS,IAAT,EAAc;AACtD,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAFD;AAGA,EArCa;AAsCd,SAAO,UAAS,GAAT,EAAa,GAAb,EAAiB,KAAjB,EAAuB;AAC7B,QAAM,YAAN,CAAmB,EAAC,KAAI,MAAM,GAAX,EAAnB,EAAmC;AAClC,aAAU,MAAM,QADkB;AAElC,WAAO,MAAM,MAFqB;AAGlC,aAAS,MAAM,QAHmB;AAIlC,UAAM,MAAM,KAJsB;AAKlC,WAAO,MAAM,MALqB;AAMlC,YAAQ,MAAM,OANoB;AAOlC,SAAK,MAAM;AAPuB,GAAnC,EAQG,IARH,CAQQ,UAAS,IAAT,EAAc;AACrB,OAAI,IAAJ,CAAS,OAAO,YAAP,CAAoB,IAApB,CAAT;AACA,GAVD;AAWA;AAlDa,CAAf;;AAqDA,OAAO,OAAP,GAAiB,YAAjB","file":"workService-compiled.js","sourcesContent":["var co = require('co');\nvar works = require('../models/works').works;\nvar workTypeService = require('./workTypeService');\nvar _ = require('lodash');\nworksService = {\n\t//这里是保存实体\n\tsaveEntity:function(req,res,param){\n\t\tvar result1 = works.saveEntity({\n\t\t\tworkType: param.workType,\n\t\t\tsortNo:param.sortNo,\n\t\t\tloadTime:param.loadTime,\n\t\t\ttitle:param.title,\n\t\t\tperson:param.person,\n\t\t\tcontent:param.content,\n\t\t\tlogo:param.logo\n\t\t}).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t});\n\t},\n\tquery:function(req,res,param){\n\t\tworks.findByCondition(param).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t});\n\t},\n\tqueryAndType : function(req,res,param) {\n\t\tco(\n\t\t\tfunction*() {\n\t\t\t\tvar result1 = yield works.findByCondition(param);\n\t\t\t\tvar types =  _.map(result1,'workType');\n\t\t\t\tvar result2 = yield workTypeService.queryByIds(types);\n\t\t\t\tresult1.forEach(x=>x.workType = (result2.find(y=>y._id==x.workType))?(result2.find(y=>y._id==x.workType)).name:'');\n\t\t\t\treturn result1;\n\t\t\t}\n\t\t).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t})\n\t},\n\tdelete:function(req,res,param){\n\t\tworks.deleteEntity({_id:param._id}).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t});\n\t},\n\tupdate:function(req,res,param){\n\t\tworks.updateEntity({_id:param._id},{\n\t\t\tworkType: param.workType,\n\t\t\tsortNo:param.sortNo,\n\t\t\tloadTime:param.loadTime,\n\t\t\ttitle:param.title,\n\t\t\tperson:param.person,\n\t\t\tcontent:param.content,\n\t\t\tlogo:param.logo\n\t\t}).then(function(data){\n\t\t\tres.send(global.configResult(data));\n\t\t});\n\t}\n}\n\nmodule.exports = worksService;\n"]}