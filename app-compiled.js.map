{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app-compiled.js","sourcesContent":["//初始化配置：配置跟路径\nglobal.root_dirName = __dirname;\n\nvar express = require('express');\nvar path = require('path');\nvar favicon = require('serve-favicon');\nvar logger = require('morgan');\nvar cookieParser = require('cookie-parser');\nvar bodyParser = require('body-parser');\n\n//var routes = require('./routes/index');\n//var users = require('./routes/users');\nvar http = require('http');\nvar util =  require('util')\n\nvar Result =  require('./sys/entity/result.js');\nvar config =  require('./sys/config/Config.js');\nvar StringUtil =  require('./sys/util/StringUtil.js');\n\n//配置服务对象 \nconfig.configServiceObj();\n\n//mongodb setting\nvar mongoose = require('mongoose');\nmongoose.Promise = global.Promise;//内置使用的是bluebird,现在换成原生的,后期有空再弄\nmongoose.connect('mongodb://dapaer:dapaer@localhost:27017/node');\n\nvar app = express();\n\n// view engine setup\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'jade');\n\n// uncomment after placing your favicon in /public\n//app.use(favicon(path.join(__dirname, 'public', 'favicon.ico')));\napp.use(logger('dev'));\napp.use(bodyParser.urlencoded({ extended: false }));\n//app.use(bodyParser.json());\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, 'public')));\n\n//app.use('/', routes);\n//app.use('/users', users);\n\n\n\n\n\n//统一配置拦截器\napp.all(/^\\/server\\/([A-Z,a-z,0-9])+!([A-Z,a-z,0-9])+$/,function(req,res){\n  var url =  req.url;\n  var actionName = StringUtil.getActionName(url);\n  var methodName = StringUtil.getMethodName(url);\n  var action = config.servicesObj[actionName];\n  var params = req.body;\n  if(req.method=='GET'){\n    params = req.query;\n  }\n  if(params.page&&params.pageSize){\n    params.pageObj = {\n      page:params.page,\n      pageSize:params.pageSize\n    }\n    delete params.page;\n    delete params.pageSize;\n    delete params.ft_pageCount;\n  }\n  if(util.isFunction(action[methodName])){\n    action[methodName](req,res,params);\n  }\n  else{\n    var result = new Result();\n    result.configError(actionName+\"类或\"+methodName+\"方法未实现!!!\");\n    res.send(result);\n  }\n})\n\n\n// catch 404 and forward to error handler\napp.use(function(req, res, next) {\n  var err = new Error('Not Found');\n  err.status = 404;\n  next(err);\n});\n\n// error handlers\n\n// development error handler\n// will print stacktrace\nif (app.get('env') === 'development') {\n  app.use(function(err, req, res, next) {\n    res.status(err.status || 500);\n    res.render('error', {\n      message: err.message,\n      error: err\n    });\n  });\n}\n\n// production error handler\n// no stacktraces leaked to user\napp.use(function(err, req, res, next) {\n  res.status(err.status || 500);\n  res.render('error', {\n    message: err.message,\n    error: {}\n  });\n});\n\nhttp.createServer(app).listen(3000,function(req,res){\n  console.info(\"start the server!!!\");\n});\nmodule.exports = app;\n"]}