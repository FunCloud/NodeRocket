{"version":3,"sources":["dbHelper.js"],"names":[],"mappings":";;;AAGA,IAAI,WAAW,QAAQ,UAAR,CAAf;AACA,IAAI,SAAS,SAAS,MAAtB;;AAEA,IAAI,YAAY,UAAU,IAAV,EAAgB,QAAhB,EAA0B,KAA1B,EAAiC,QAAjC,EAA2C,WAA3C,EAAwD,UAAxD,EAAoE,QAApE,EAA8E;AAC1F,QAAI,QAAQ,CAAC,OAAO,CAAR,IAAa,QAAzB;AACA,QAAI,QAAQ;AACR,oBAAY;AADJ,KAAZ;AAGA,UAAM,QAAN,CAAe;AACX,eAAO,UAAU,IAAV,EAAgB;;AACnB,kBAAM,KAAN,CAAY,WAAZ,EAAyB,IAAzB,CAA8B,UAAU,GAAV,EAAe,KAAf,EAAsB;AAChD,qBAAK,GAAL,EAAU,KAAV;AACH,aAFD;AAGH,SALU;AAMX,iBAAS,UAAU,IAAV,EAAgB;;AACrB,kBAAM,IAAN,CAAW,WAAX,EAAwB,IAAxB,CAA6B,KAA7B,EAAoC,KAApC,CAA0C,QAA1C,EAAoD,QAApD,CAA6D,QAA7D,EAAuE,IAAvE,CAA4E,UAA5E,EAAwF,IAAxF,CAA6F,UAAU,GAAV,EAAe,GAAf,EAAoB;AAC7G,qBAAK,GAAL,EAAU,GAAV;AACH,aAFD;AAGH;AAVU,KAAf,EAWG,UAAU,GAAV,EAAe,OAAf,EAAwB;AACvB,YAAI,QAAQ,QAAQ,KAApB;AACA,cAAM,SAAN,GAAkB,CAAC,QAAQ,CAAT,IAAc,QAAd,GAAyB,CAA3C;AACA,cAAM,OAAN,GAAgB,QAAQ,OAAxB;AACA,iBAAS,GAAT,EAAc,KAAd;AACH,KAhBD;AAiBH,CAtBD;;AAwBA,OAAO,OAAP,GAAiB;AACb,eAAW;AADE,CAAjB","file":"dbHelper-compiled.js","sourcesContent":["/**\n * Created by dapaer on 16/7/31.\n */\nvar mongoose = require('mongoose');\nvar Schema = mongoose.Schema;\n\nvar pageQuery = function (page, pageSize, Model, populate, queryParams, sortParams, callback) {\n    var start = (page - 1) * pageSize;\n    var $page = {\n        pageNumber: page\n    };\n    async.parallel({\n        count: function (done) {  // 查询数量\n            Model.count(queryParams).exec(function (err, count) {\n                done(err, count);\n            });\n        },\n        records: function (done) {   // 查询一页的记录\n            Model.find(queryParams).skip(start).limit(pageSize).populate(populate).sort(sortParams).exec(function (err, doc) {\n                done(err, doc);\n            });\n        }\n    }, function (err, results) {\n        var count = results.count;\n        $page.pageCount = (count - 1) / pageSize + 1;\n        $page.results = results.records;\n        callback(err, $page);\n    });\n};\n\nmodule.exports = {\n    pageQuery: pageQuery\n};\n"]}